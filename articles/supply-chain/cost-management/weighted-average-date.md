---
title: 具有「包括實際成本和標記」的加權平均日期
description: 加權平均日期是一種基於加權平均原則的庫存模型，其中來自庫存的發貨按庫存關帳期間每個單獨日期入庫的品項的平均值計價。
author: AndersGirke
ms.date: 03/04/2022
ms.topic: article
ms.search.form: InventJournalLossProfit, InventMarking, InventModelGroup, SalesTable
audience: Application User
ms.reviewer: kamaybac
ms.custom: 28991
ms.search.region: Global
ms.author: aevengir
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: 3cf2206863d891eceb9c65ff879da3f9f72032b1
ms.sourcegitcommit: fcded93fc6c27768a24a3d3dc5cc35e1b4eff22b
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/07/2022
ms.locfileid: "8450105"
---
# <a name="weighted-average-date-with-include-physical-value-and-marking"></a>具有「包括實際成本和標記」的加權平均日期

[!include [banner](../includes/banner.md)]

*加權平均日期* 是一種基於平均值的庫存模型，該平均值將每個組件 (品項交易) 乘以反映其在該期間每一天的重要性 (數量) 的係數 (成本價格) 來計算。 換句話說，此庫存模型根據每天收到的所有庫存的平均值加上前一天的任何現有庫存來分配發貨交易的成本。

當您使用加權平均日期庫存模型執行庫存結算時，可以使用兩種方法來建立結算。 通常，將根據虛擬發貨結算所有收貨，這將保留收貨總數量和值。 此虛擬發貨具有將從其結算發貨的相應虛擬收貨。 這樣，所有發貨每天都會具有相同的平均成本。 虛擬發貨和虛擬收貨可視為虛擬轉移。 這種虛擬轉移稱為 *加權平均庫存結算轉移*。 因此，這種結算方式稱為 *加權平均匯總結算*。 如果只有一個收貨，則可以根據該收貨結算所有發貨，並且將不建立虛擬轉移。 這種結算方式稱為 *直接結算*。 執行庫存結轉後的任何現有庫存均按上一期間最後一天的加權平均估值，包括在下一期間的加權平均日期計算中。

您可以透過標記庫存交易來替代加權平均日期原則，以針對特定發貨結算特定品項收貨。 當您使用加權平均日期庫存模型依加權平均日期原則建立結算即調整發貨值時，需要定期結轉庫存。 在執行庫存結轉之前，當發生實際和財務更新時，發貨交易將按移動平均值進行評估。 除非您使用標記，否則執行實體或財務更新時，會計算執行平均值。

每天使用以下公式計算加權平均日期庫存結轉法：

*成本* = \[(*Q*<sub>*b*</sub> × *P*<sub>*b*</sub>) + &#x2211;<sub>*n*</sub>(*Q*<sub>*n*</sub> × *P*<sub>*n*</sub>)\] ÷ (*Q*<sub>*b*</sub> + &#x2211;<sub>*n*</sub>*Q*<sub>*n*</sub>)

- *Q* = 交易的數量
- *P* = 交易的價格

換句話說，加權平均成本等於起始數量乘以起始價格，加上每個收貨數量總和乘以其收貨價格，再除以起始數量加上收貨數量總和。

在庫存結轉期間，將在結轉期間每天執行計算。

> [!NOTE]
> 有關結算的詳細資訊，請參閱[庫存結轉](inventory-close.md)。

以下範例透過五種設定顯示使用加權平均日期的影響：

- 不使用 **包括實際成本** 選項時的加權平均日期直接結算
- 不使用 **包括實際成本** 選項時的加權平均日期匯總結算
- 使用 **包括實際成本** 選項時的加權平均日期直接結算
- 使用 **包括實際成本** 選項時的加權平均日期匯總結算
- 使用標記時的加權平均日期

## <a name="weighted-average-date-direct-settlement-when-the-include-physical-value-option-isnt-used"></a>不使用包括實際成本選項時的加權平均日期直接結算

直接結算原則直接在收貨和發貨之間建立結算，而不建立額外的庫存交易。 系統在以下情況會使用這種直接結算原則：

- 已在該期間過帳一個收貨和一個或多個發貨。
- 該期間僅過帳發貨，且庫存包含先前結轉的現有品項。

在這個範例中，清除了已發布產品的 **品項模型群組** 頁面上的 **包括實際成本** 核取方塊。 下圖說明這些交易：

**第 1 天：**

- 1a. 數量 10 (單件成本為 10.00 美元) 的庫存實際收貨。
- 1b. 數量 10 (單件成本為 10.00 美元) 的庫存財務收貨。
- 2a. 數量 10 (單件成本為 20.00 美元) 的庫存實際收貨。
- 3a. 數量 1 (單件成本價為 10.00 美元) 的庫存實際發貨 (財務過帳的交易的移動平均)。
- 3b. 數量 1 (單件成本為 10.00 美元) 庫存財務發貨 (財務過帳的交易移動平均)。

**第 2 天：**

- 4a. 數量 1 (單件成本為 25.00 美元) 的庫存實際收貨。
- 5a. 數量 1 (單件成本為 30.00 美元) 的庫存實際收貨。
- 5b. 數量 1 (單件成本為 30.00 美元) 的庫存財務收貨。
- 6a. 數量 1 (單件成本為 USD 20.00) 庫存財務發貨 (財務過帳的交易移動平均)。

**第 3 天：**

- 7\. 已執行庫存結轉。 基於加權平均日期法，系統對 12 月 30 日 (12/30) 使用直接結算方法，因為在 12/30 只對一個收貨進行財務更新。 在此範例中，系統在交易 1b 和 3b 之間建立了一項結算。 對 10.00 美元進行調整，以使交易 3b 的值達到 20.00。 12 月 31 日 (12/31) 沒有進行任何調整或結算，因為 12 月 31 日沒有財務更新的發貨。

下圖顯示此系列的交易，以及使用加權平均庫存模型和直接結算原則 (沒有 **包括實際成本** 選項) 的影響。

![沒有包括實際成本選項時的加權平均日期直接結算。](media/weighted-average-date-direct-settlement-without-include-physical-value.png)

**圖表要點：**

- 庫存交易由垂直的箭頭表示。
- 實際交易由淺灰色的短箭頭表示。
- 財務交易由黑色的長箭頭表示。
- 庫存收貨依座標軸上方的垂直箭頭顯示。
- 庫存出貨依座標軸下方的垂直箭頭顯示。
- 每個新的接收貨發貨交易，都由新的標籤指定。
- 每個垂直箭頭都標有順序識別碼，例如 *1a*。 識別碼表示庫存交易在時間表上過帳的順序。
- 日期由細黑色垂直線分隔。 日期在圖表底部註明。
- 庫存結算由紅色垂直虛線表示。
- 由庫存結算執行的結算作業，由紅色的虛線箭頭表示，方向從接受到發貨。

## <a name="weighted-average-date-summarized-settlement-when-the-include-physical-value-option-isnt-used"></a>不使用包括實際成本選項時的加權平均日期匯總結算

當一個期間有多個收貨時，加權平均日採用匯總結算原則，將一天內的所有收貨匯總到名為 *加權平均庫存結轉* 的交易記錄中。 當天的所有收貨都將根據新建立的庫存交易的發貨進行結算。 當天的所有發貨都將根據新的庫存交易的收貨進行結算。 如果庫存結轉後還有剩餘的現有庫存量值，則現有庫存量值將包含在加權平均庫存結轉交易記錄的收貨交易記錄中。

下圖說明這些交易：

**第 1 天：**

- 1a. 數量 1 (單件成本為 10.00 美元) 的庫存實際收貨。
- 1b. 數量 1 (單件成本為 10.00 美元) 的庫存財務收貨。
- 2a. 數量 1 (單件成本為 20.00 美元) 的庫存實際收貨。
- 2b. 數量 1 (單件成本為 22.00 美元) 的庫存財務收貨。
- 3a. 數量 1 (單件成本價為 16.00 美元) 的庫存實際發貨 (財務過帳的交易的移動平均)。
- 3b. 數量 1 (單件成本價為 16.00 美元) 庫存財務發貨 (財務過帳的交易移動平均)。

**第 2 天：**

- 4a. 數量 1 (單件成本為 25.00 美元) 的庫存實際收貨。
- 5a. 數量 1 (單件成本為 30.00 美元) 的庫存實際收貨。
- 5b. 數量 1 (單件成本為 30.00 美元) 的庫存財務收貨。
- 6a. 數量 1 (單件成本價為 23.00 美元) 的庫存實際發貨 (財務過帳的交易的移動平均)。

**第 3 天：**

- 7\. 已執行庫存結轉。
- 7a. 建立加權平均庫存結算交易財務發貨，以計算所有庫存財務收貨結算總和。

    - 交易 1b 的結算數量為 1，結算金額為 10.00 美元。
    - 交易 2b 的結算數量為 1，結算金額為 22.00 美元。
    - 建立的交易 7a 的數量為 2，結算金額為 32.00 美元。 此交易抵消了期間內財務更新的兩個收貨交易的總和。

- 7b. 建立加權平均庫存結轉交易財務收貨，作為財務過帳發貨的抵消。

    - 交易記錄 3b 的結算數量為 1，結算金額為 16.00 美元。 此交易未經過調整，因為它是 12 月 1 日 (12/1) 財務過帳交易的加權平均值。
    - 創建的交易 7b 的數量為 2，其財務金額為 32.00 美元，對方交易 3b 的結算金額為 16.00 美元。 此交易抵消了期間內財務更新的一個發貨交易的總和。 交易仍然未結，因為仍有一筆現有交易。

下圖顯示此系列的交易，以及使用加權平均庫存模型和匯總結算原則 (但沒有使用 **包括實際成本** 選項) 的影響。

![沒有包括實際成本選項時的加權平均日期匯總結算。](media/weighted-average-date-summarized-settlement-without-include-physical-value.png)

**圖表要點：**

- 庫存交易由垂直的箭頭表示。
- 實際交易由淺灰色的短箭頭表示。
- 財務交易由黑色的長箭頭表示。
- 庫存收貨依座標軸上方的垂直箭頭顯示。
- 庫存出貨依座標軸下方的垂直箭頭顯示。
- 每個新的接收貨發貨交易，都由新的標籤指定。
- 每個垂直箭頭都標有順序識別碼，例如 *1a*。 識別碼表示庫存交易在時間表上過帳的順序。
- 日期由細黑色垂直線分隔。 日期在圖表底部註明。
- 庫存結算由紅色垂直虛線表示。
- 由庫存結算執行的結算作業，由紅色的虛線箭頭表示，方向從接受到發貨。

## <a name="weighted-average-date-direct-settlement-when-the-include-physical-value-option-is-used"></a>使用包括實際成本選項時的加權平均日期直接結算

在目前版本的產品中，**包括實際成本** 選項在加權平均日期庫存模型中的使用方式與在早期版本中的使用方式不同。 如果選取 **品項模型群組** 頁面中的 **包括實際成本** 核取方塊，此系統將在計算估計的發貨成本價或移動平均值時使用實際更新的收貨。 在此期間，將根據此估計成本價格過帳發貨。 在庫存結轉期間，在加權平均計算時僅考慮財務更新的收貨。

下圖說明這些交易：

**第 1 天：**

- 1a. 數量 10 (單件成本為 10.00 美元) 的庫存實際收貨。
- 1b. 數量 10 (單件成本為 10.00 美元) 的庫存財務收貨。
- 2a. 數量 10 (單件成本為 20.00 美元) 的庫存實際收貨。
- 3a. 數量 1 (單件成本價為 15.00 美元) 的庫存財務發貨 (實際和財務過帳的交易移動平均)
- 3b. 數量 1 (單件成本價為 15.00 美元) 的庫存實際發貨 (實際和財務過帳的交易移動平均)

**第 2 天：**

- 4a. 數量 1 (單件成本為 25.00 美元) 的庫存實際收貨。
- 5a. 數量 1 (單件成本為 30.00 美元) 的庫存實際收貨。
- 5b. 數量 1 (單件成本為 30.00 美元) 的庫存財務收貨。
- 6a. 數量 1 (單件成本價為 USD 21.25) 的庫存財務發貨 (實際和財務過帳的交易移動平均)

**第 3 天：**

- 7\. 已執行庫存結轉。 基於加權平均日期法，系統對 12 月 30 日 (12/30) 使用直接結算方法，因為在 12/30 只對一個收貨進行財務更新。 在此範例中，系統在交易 1b 和 3b 之間建立了一項結算。 12/30 未對發貨進行任何調整。 此外，12 月 31 日 (12/31) 沒有進行任何調整或結算，因為 12 月 31 日 (12/31) 沒有財務更新的發貨。

下圖顯示此系列的交易，以及使用加權平均庫存模型和直接結算原則 (具有 **包括實際成本** 選項) 的影響。

![具有包括實際成本時的加權平均直接結算。](media/weighted-average-date-direct-settlement-with-include-physical-value.png)

**圖表要點：**

- 庫存交易由垂直的箭頭表示。
- 實際交易由淺灰色的短箭頭表示。
- 財務交易由黑色的長箭頭表示。
- 庫存收貨依座標軸上方的垂直箭頭顯示。
- 庫存出貨依座標軸下方的垂直箭頭顯示。
- 每個新的接收貨發貨交易，都由新的標籤指定。
- 每個垂直箭頭都標有順序識別碼，例如 *1a*。 識別碼表示庫存交易在時間表上過帳的順序。
- 日期由細黑色垂直線分隔。 日期在圖表底部註明。
- 庫存結算由紅色垂直虛線表示。
- 由庫存結算執行的結算作業，由紅色的虛線箭頭表示，方向從接受到發貨。

## <a name="weighted-average-date-summarized-settlement-when-the-include-physical-value-option-is-used"></a>使用包括實際成本選項時的加權平均日期匯總結算

在目前版本的產品中，**包括實際成本** 選項在加權平均的使用方式與在早期版本中的使用方式不同。 如果選取 **品項模型群組** 頁面中的 **包括實際成本** 核取方塊，此系統將在計算估計的成本價或移動平均值時使用實際更新的收貨。 在此期間，將根據此估計成本價格過帳發貨。 在庫存結轉期間，在加權平均計算時僅考慮財務更新的收貨。 建議您在使用加權平均庫存模型時執行每月庫存結轉。 在此加權平均日期匯總結算範例中，將標記庫存模型以包括實際成本。

下圖說明這些交易：

**第 1 天：**

- 1a. 數量 1 (單件成本為 10.00 美元) 的庫存實際收貨。
- 1b. 數量 1 (單件成本為 10.00 美元) 的庫存財務收貨。
- 2a. 數量 1 (單件成本為 20.00 美元) 的庫存實際收貨。
- 2b. 數量 1 (單件成本為 22.00 美元) 的庫存財務收貨。
- 3a. 數量 1 (單件成本價為 16.00 美元) 的庫存財務發貨 (實際和財務過帳的交易移動平均)。
- 3b. 數量 1 (單件成本價為 16.00 美元) 的庫存實際發貨 (實際和財務過帳的交易移動平均)。

**第 2 天：**

- 4a. 數量 1 (單件成本為 25.00 美元) 的庫存實際收貨。
- 5a. 數量 1 (單件成本為 30.00 美元) 的庫存實際收貨。
- 5b. 數量 1 (單件成本為 30.00 美元) 的庫存財務收貨。
- 6a. 數量 1 (單件成本價為 23.67 美元) 的庫存財務發貨 (實際和財務過帳的交易移動平均)。

**第 3 天：**

- 7\. 已執行庫存結轉。
- 7a. 建立加權平均庫存結算交易財務發貨，以計算所有庫存財務收貨結算總和。

    - 交易 1b 的結算數量為 1，結算金額為 10.00 美元。
    - 交易 2b 的結算數量為 1，結算金額為 22.00 美元。
    - 建立的交易 7a 的數量為 2，結算金額為 32.00 美元。 此交易抵消了期間內財務更新的兩個收貨交易的總和。

- 7b. 建立加權平均庫存結轉交易財務收貨，作為財務過帳發貨的抵消。

    - 交易記錄 3b 的結算數量為 1，結算金額為 16.00 美元。 此交易未經過調整，因為它是 12 月 1 日 (12/1) 財務過帳交易的加權平均值。
    - 創建的交易 7b 的數量為 2，其財務金額為 32.00 美元，對方交易 3b 的結算金額為 16.00 美元。 此交易抵消了期間內財務更新的一個發貨交易的總和。 交易仍然未結，因為仍有一筆現有交易。

下圖顯示此系列的交易，以及使用加權平均庫存模型和匯總結算原則 (沒有 **包括實際成本** 選項) 的影響。

![具有包括實際成本時的加權平均匯總結算。](media/weighted-average-date-summarized-settlement-with-include-physical-value.png)

**圖表要點：**

- 庫存交易由垂直的箭頭表示。
- 實際交易由淺灰色的短箭頭表示。
- 財務交易由黑色的長箭頭表示。
- 庫存收貨依座標軸上方的垂直箭頭顯示。
- 庫存出貨依座標軸下方的垂直箭頭顯示。
- 每個新的接收貨發貨交易，都由新的標籤指定。
- 每個垂直箭頭都標有順序識別碼，例如 *1a*。 識別碼表示庫存交易在時間表上過帳的順序。
- 日期由細黑色垂直線分隔。 日期在圖表底部註明。
- 庫存結算由紅色垂直虛線表示。
- 由庫存結算執行的結算作業，由紅色的虛線箭頭表示，方向從接受到發貨。

## <a name="weighted-average-date-when-marking-is-used"></a>使用標記時的加權平均日期

標記是讓您將發貨交易與接收交易建立連結、標記的程序。 交易過帳之前或之後都可以進行標記。 當您希望在過帳交易或執行庫存結轉時確定庫存的確切成本時，可以使用標記。

例如，您的客戶服務部門接受了一位重要客戶的緊急訂單。 由於這是緊急訂單，所以您必須為此品項支付更多費用才能滿足客戶要求。 您必須確保此庫存品項的成本反映在此銷售訂單發票的利潤或銷售成本 (COGS) 中。

訂購單過帳時，庫存會收到 120.00 美金的成本。 如果在過帳裝箱單或發票前將銷售訂單文件標記到訂購單，則 COGS 將為 120.00 美元，而不是品項的目前執行平均成本。 如果標記發生在銷售訂單裝箱單或發票過帳後，則 COGS 將按移動平均成本價過帳。

執行庫存結轉之前，兩個交易仍可以互相標記。

將收貨交易標記為出貨交易時，系統會忽略品項模型群組中選擇的估價方法，且將這些交易相互結算。

您可以在交易過帳之前，將發貨交易標記到收貨。 您可以從 **銷售訂單詳細資料** 頁面上的銷售訂單行執行此標記。 未結收貨交易顯示在 **行銷** 頁面。

您也可以在交易過帳後將發貨交易標記到收貨。 您可以針對已過帳庫存調整日記帳中的庫存品項，將出貨交易配對或標記到未結算的收貨交易。

下圖說明這些交易：

**第 1 天：**

- 1a. 數量 1 (單件成本為 10.00 美元) 的庫存實際收貨。
- 1b. 數量 1 (單件成本為 10.00 美元) 的庫存財務收貨。
- 2a. 數量 1 (單件成本為 20.00 美元) 的庫存實際收貨。
- 2b. 數量 1 (單件成本為 22.00 美元) 的庫存財務收貨。
- 3a. 數量 1 (單件成本價為 16.00 美元) 的庫存實際發貨 (財務過帳的交易的移動平均)。
- 3b. 數量 1 (單件成本價為 16.00 美元) 庫存財務發貨 (財務過帳的交易移動平均)。
- 3c. 交易 3b 的庫存財務發貨將被標記為交易 2b 的庫存財務發貨。

**第 2 天：**

- 4a. 數量 1 (單件成本為 25.00 美元) 的庫存實際收貨。
- 5a. 數量 1 (單件成本為 30.00 美元) 的庫存實際收貨。
- 5b. 數量 1 (單件成本為 30.00 美元) 的庫存財務收貨。
- 6a. 數量 1 (單件成本價為 23.00 美元) 的庫存實際發貨 (財務過帳的交易的移動平均)。

**第 3 天：**

- 7\. 已執行庫存結轉。 根據使用加權平均方法的標記原則，將標記的交易相互結算。 在此範例中，交易 3b 針對交易 2b 進行結算，並將 6.00 美元的調整過帳到交易 3b 以將值達到 22.00 美元。 在此範例中，沒有進行額外的結算，因為結轉僅為財務更新的交易建立結算。

下圖顯示了此系列交易，以及使用具有標記的加權平均庫存模型的影像。

![具有標記的加權平均。](media/weighted-average-date-with-marking.png)

**圖表要點：**

- 庫存交易由垂直的箭頭表示。
- 實際交易由淺灰色的短箭頭表示。
- 財務交易由黑色的長箭頭表示。
- 庫存收貨依座標軸上方的垂直箭頭顯示。
- 庫存出貨依座標軸下方的垂直箭頭顯示。
- 每個新的接收貨發貨交易，都由新的標籤指定。
- 每個垂直箭頭都標有順序識別碼，例如 *1a*。 識別碼表示庫存交易在時間表上過帳的順序。
- 日期由細黑色垂直線分隔。 日期在圖表底部註明。
- 庫存結算由紅色垂直虛線表示。
- 由庫存結算執行的結算作業，由紅色的虛線箭頭表示，方向從接受到發貨。

[!INCLUDE[footer-include](../../includes/footer-banner.md)]
