---
title: 自動分配費用
description: Microsoft Dynamics 365 Supply Chain Management 的費用功能幫助您自動將費用分配給採購訂單或銷售訂單。
author: Henrikan
ms.date: 09/30/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
audience: Application User
ms.reviewer: kamaybac
ms.search.region: Global
ms.author: henrikan
ms.search.validFrom: 2020-10-01
ms.dyn365.ops.version: 10.0.15
ms.openlocfilehash: 6032539e57961998e7130e9cb6578248aaa2843e
ms.sourcegitcommit: 49f29aaa553eb105ddd5d9b42529f15b8e64007e
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/01/2021
ms.locfileid: "8449379"
---
# <a name="automatic-allocation-of-charges"></a>自動分配費用

[!include [banner](../includes/banner.md)]

根據您正在合作的客戶或您正在銷售的商品，您可能需要套用特定的額外費用。 Microsoft Dynamics 365 Supply Chain Management 的 *費用* 功能幫助您自動將費用分配給採購訂單或銷售訂單。

建立銷售訂單或訂購單時會自動套用自動費用 (或 auto charges)。 您可以為特定供應商、客戶、供應商組或品項定義自動費用。 您還可以定義套用在所有供應商、客戶或品項的自動費用。

## <a name="set-up-parameters"></a>設定參數

當您想要自動分配費用時，**採購和開源參數** 頁面有一些非常重要的設定。 要完成此設定，請按照以下步驟操作。

1. 移至 **採購和開源 \> 設定 \> 採購和開源參數**。
1. 打開 **價格** 索引標籤。
1. 在 **價格** 快速索引標籤，請進行以下設定：
    - **查找標頭的自動費用**–指定是否應對訂購單標頭自動分配費用。 將此設定為 *是的* 使用自動分配費用。
    - **查找明細的自動費用**–指定是否應對訂購單明細自動分配費用。 將此設定為 *是的* 使用自動分配費用。

## <a name="set-up-charges-codes"></a>設定費用代碼

要分配費用，您必須首先定義費用代碼。

1. 請執行以下其中一個步驟：

    - 對於訂購單：請移至 **應付賬款\>費用設定\>費用代碼**。
    - 對於銷售訂單：請移至 **應收賬款\>費用設定\>費用代碼**。

1. 在動作窗格上，請選取 **新增** 建立費用代碼。
1. 在新記錄的標頭中，設定以下欄位：

    - **費用代碼**–輸入費用代碼。
    - **說明** – 輸入費用的說明。
    - **品項銷售稅群組** – 選取品項銷售稅群組 (如果適用)。
    - **按比例**– 如果您想按比例計算費用，請將此選項設定為 *確定*。 此選項僅適用於銷售訂單。
    - **最高金額**– 輸入費用代碼允許的最大金額。 此欄位用於驗證供應商發票的費用。 它僅適用於訂購單。

        > [!NOTE]
        > 要打開驗證訂購單費用的功能，請轉到 **應付賬款\>設定\>應付賬款參數**。 在 **發票驗證** 快速索引標籤，到 **發票驗證** 區段，請設定 **啟用發票匹配驗證** 選項為 *確定*。

1. **過帳** 快速索引標籤，包括 **借方** 和 **貸方** 區段。 根據您要將費用過帳到哪個分類帳，設定以下欄位：

    - **類型**–選取您要過帳到哪個類型的帳戶 (*分類帳*、*顧客*，或 *品項*)。
    - **過帳**– 選擇要建立過帳類型 (例如 *中介費* 或 *客戶結算*)。
    - **科目**–選擇要過帳費用的科目。

1. 在動作窗格上，選擇 **儲存**。

## <a name="create-charge-groups"></a>建立費用群組

費用群組自動將特定費用分配給一組客戶或供應商。 以下小節介紹如何建立和指派這些費用群組。

### <a name="charge-groups-for-purchase-orders"></a>訂購單的費用群組

若要為訂購單建立費用群組，請執行以下步驟。

1. 請移至 **應付賬款\>費用設定\>供應商費用群組**.
1. 在動作窗格上，請選取 **新增** 在網格中新增一列，然後設定以下欄位：

    - **費用群組**–輸入費用群組的名稱。
    - **說明** – 輸入費用群組的說明。

1. 在動作窗格上，選擇 **儲存**。
1. 請移至 **應付賬款\>供應商\>所有供應商**，然後打開現有供應商或建立新供應商。
1. 在 **訂購單預設值** 快速索引標籤，到 **訂購單** 區段，請設定 **費用群組** 欄位，以新增到您剛剛建立的費用群組。

### <a name="charge-groups-for-sales-orders"></a>銷售訂單的費用群組

若要為銷售訂單建立費用群組，請執行以下步驟。

1. 請移至 **應收賬款\>費用設定\>客戶費用群組**.
1. 在動作窗格上，請選取 **新增** 在網格中新增一列，然後設定以下欄位：

    - **費用群組**–輸入費用群組的名稱。
    - **說明** – 輸入費用群組的說明。

1. 在動作窗格上，選擇 **儲存**。
1. 請移至 **應收賬款\>客戶\>所有客戶**，然後打開現有客戶或建立新客戶。
1. 在 **訂購單預設值** 快速索引標籤，到 **銷售訂單** 區段，請設定 **費用群組** 欄位，以新增到您剛剛建立的費用群組。

## <a name="define-auto-charges"></a>定義自動費用

設定費用代碼後，請按照以下步驟定義自動費用。

1. 請執行以下其中一個步驟：

    - 對於訂購單：請移至 **採購和開源\>設定\>費用\>自動費用**。
    - 對於銷售訂單：請移至 **應收賬款 \> 設定 \> 費用設定 \> 自動費用**。

1. 在列表窗格中，到 **層面** 欄位，請選取自動費用適用的層面：

    - *主要* – 將費用套用到訂單標頭。
    - *明細* – 將費用套用到訂單明細。

1. 請選取現有的自動費用進行編輯，或選取 **新增** 定義新的自動費用。
1. 在 **科目代碼** 列表中，選取以下任一值來指定將受影響的科目範圍：

    - *資料表*–將費用指派給特定客戶或供應商。
    - *群組*–將費用指派給雜項費用群組。
    - *全部*–將費用指派給所有客戶或供應商。

1. 在 **客戶關係** 或 **供應商關係** 欄位，如果您設定 **科目代碼** 欄位為 *資料表*，請選擇特定客戶或供應商。 如果 **科目代碼** 欄位中已選取 *群組*，請選取客戶或供應商費用群組。
1. 在 **品項代碼** 欄位中，選取以下任一值來指定將受影響的品項範圍。 只有在明細層面定義自動費用時，才能選擇品項代碼。

    - *資料表*–將費用分配給特定品項。
    - *群組*–將費用指派給品項費用群組。
    - *全部*–為所有品項指派費用。

1. 在 **品項關係** 欄位，如果您設定 **品項代碼** 欄位為 *資料表*，請選取特定品項。 如果 **品項代碼** 欄位中已選取 *群組*，請選取品項費用群組。
1. **僅適用於銷售訂單：** 在 **交貨模式代碼** 欄位，請選擇以下任一值以指定將受到影響的交貨模式的範圍：

    - *資料表*–將費用指派給特定的交貨模式。
    - *群組*–將費用指派給特定的交貨群組。
    - *全部*–為所有交貨模式指派費用。

1. **僅適用於銷售訂單：** 在 **交貨模式關係** 欄位，如果您設定 **交貨模式代碼** 欄位為 *資料表*，請選取特定交貨模式。 如果你設定 **交貨模式代碼** 欄位為 *群組*，請選取交貨模式群組。
1. 在 **明細** 快速索引標籤，定義當前自動費用套用時將使用的費用和費率。 您可以使用此快速索引標籤上的工具列新增需要的明細數量。 對於每一個明細，設定下列欄位：

    - **貨幣**–選取用於計算費用的貨幣。
    - **費用代碼**–選取費用代碼。
    - **類別** – 請選取下列其中一個值：

        - *固定的*–在明細中費用以固定金額輸入。 固定費用可用於在訂單標頭和訂單明細中的費用。
        - *件*–按單位計算費用。 這些費用只能用於訂單明細。 它們會在您計算訂單總額時出現。
        - *比例*–在明細中費用以比例形式輸入。 比例費用可用於在訂單標頭和訂單明細中的費用。
        - *公司間百分比*–在公司間訂單明細中費用以百分比形式輸入。 公司間百分比費用只能用於訂單明細。
        - *外部的*–費用由與運輸承運人關聯的一個或多個第三方服務計算。

    - **費用值**–根據您選取的類別輸入費用值。
    - **費用貨幣代碼**– 如果您想使用的貨幣，不是在 **貨幣** 欄位指定的貨幣，請為費用指定一種貨幣。 如果已選費用代碼的 **借方類型** 或 **貸方類型** 設定為 *分類帳科目* 或 *品項*，則可以使用不同的貨幣。
    - **起始金額**–指定套用自動費用的起始金額。 在這種情況下，總額是指訂單總額。
    - **上限總額**–指定套用自動費用的上限總額。 在這種情況下，總額是指訂單總額。
    - **銷售稅群組**–指定銷售稅組。
    - **站點** 和 **倉庫**–如果僅對特定站點和倉庫套用費用，請指定站點和倉庫。
    - **保留**– 選取此核取方塊可在出貨完成後保留費用交易記錄，以便每次為已選客戶帳戶建立新發票時都會套用費用。

1. **僅適用於銷售訂單：** 如需計算分級費用的更多資料，請參閱[銷售訂單的分級費用](/dynamicsax-2012/appuser-itpro/about-tiered-charges-on-sales-orders)。

## <a name="allocate-charges-from-the-header-to-a-line"></a>將標頭中的費用分配到明細

以下過程表示如何將標頭層級的費用分配到明細。 在開始此過程之前，您應該已經有 *固定金額* 類型的標頭層級費用和套用該費用的訂單。 此外，訂單應該已經包含至少一個訂單明細品項。

1. 打開訂購單或費用訂單。
1. 在動作窗格上，執行以下任一步驟：

    - 對訂購單：在 **採購** 索引標籤，請到 **費用** 群組，選擇 **分配費用**。
    - 對銷售訂單：在 **銷售** 索引標籤，請到 **費用** 群組，選擇 **分配費用**。

1. 在 **將費用分配到訂單明細** 對話方塊，設定以下欄位：

    - **費用分配**–選擇以下任一值來指定應如何分配費用：

        - *淨額*–根據每個有關總淨額的明細總額進行費用分配。
        - *數量*–根據每個有關單位總數的明細，以其單位數量進行費用分配。
        - *每個明細*–依總明細數量中平均分配費用。

    - **將費用分配給明細**–選取一個值以指定是否應將費用分配給所有明細、僅分配給正明細或是僅分配給負明細。
    - **分配全部** – 選取此核取方塊，以將費用分攤到訂單明細，即使費用代碼類型的借方類型不同於 *品項*。
    - **收取** – 選取此核取方塊，僅將費用分攤到收貨單明細。
    - **備貨** – 選取此核取方塊，僅將費用分攤到庫存單明細。
    - **顯示選擇並清除特定明細**– 選取此核取方塊可從此分配中排除特定明細。 選取此核取方塊，將打開 **選擇要從分配中排除的明細** 網格。 網格包含的明細，皆符合由 **將費用分攤至明細** 和 **備貨** 欄位中定義的準則。 例如，如果您將 **將費用分攤至明細** 欄位設定為 *正明細* ，並選取 **備貨** 選取方塊，則只有正數且已備貨的明細才會顯示在網格中。 此外，任何已收到全部數量的明細，網格會自動過濾掉。 當網格打開時，對應從分配中排除的每個明細，清除其 **包括** 核取方塊。 

        > [!IMPORTANT]
        > 當您使用 **選擇要從分配中排除的明細** 網格，直到您選取 **分配** 前，請務必保持網格打開。 如果在選取 **分配** 之前關閉網格，在網格中的設定將丟失。 因此，費用將根據您之前定義的標準進行分配。

1. 選取 **分配** 套用您的設定並關閉對話方塊。


[!INCLUDE[footer-include](../../includes/footer-banner.md)]
