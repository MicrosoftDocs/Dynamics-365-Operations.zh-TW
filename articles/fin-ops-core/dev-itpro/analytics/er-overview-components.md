---
title: 電子報表組件
description: 本主題介紹電子報表 (ER) 組件。
author: nselin
ms.date: 09/28/2021
ms.prod: ''
ms.technology: ''
ms.search.form: ERWorkspace
audience: Application User, Developer, IT Pro
ms.reviewer: kfend
ms.custom: 58941
ms.assetid: 5d51b6a6-ad12-4af9-a66d-a1eb820ae57f
ms.search.region: global
ms.topic: overview
ms.author: nselin
ms.search.validFrom: 2016-02-28
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: aca1b9bbca490a8a9551ed97d6e100c9115a0d41
ms.sourcegitcommit: 753714ac0dabc4b7ce91509757cd19f7be4a4793
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/01/2022
ms.locfileid: "8460584"
---
# <a name="electronic-reporting-components"></a>電子報表組件

[!include [banner](../includes/banner.md)]

電子報表 (ER) 支援以下類型的組件：

- 資料模型
- 模型對應
- 格式
- 中繼資料

## <a name="data-model-component"></a>資料模型組件

資料模型組件是資料結構的抽象表示。 它足夠詳細地描述特定的業務領域，以滿足該領域的報表要求。 資料模型組件由以下部分組成：

- **資料模型** – 一組特定領域的業務實體和這些實體之間關係的階層定義。
- **模型對應** – 選定的應用程式資料來源連結到資料模型的各個元素，該資料模型在執行階段指定資料流程和在資料模型組件中輸入業務資料的規則。

資料模型的業務實體表示為容器或記錄。 業務實體屬性表示為資料項或欄位。 每個資料項都有唯一的名稱、標籤、描述和值。 可以設計每個資料項的值，以便將其識別為字串、整數、實數、日期、列舉 (enum) 或布林值。 此外，資料項可以是另一個記錄或記錄清單。

單個資料模型組件可以包含多個特定領域業務實體的階層。 它還可以包含在執行階段支援特定於報表的資料流程的模型對應。 階層由單個記錄區分，該記錄被選為模型對應的根。 例如，付款系統區域的資料模型可能支援以下對應：


- 公司\>廠商\>AP 域的付款交易
- 客戶\>公司\>AR 域的付款交易

公司和付款交易等業務實體僅設計一次。 不同的對應可以根據需要重用它們。

## <a name="model-mapping-component"></a>模型對應組件

模型對應將應用程式資料來源連結到資料模型的各個元素，這些元素在執行階段指定用於在資料模型組件中輸入業務資料的資料流程和規則。

支援傳出電子文件的模型對應具有以下功能：

- 它可以使用不同的資料類型作為資料模型的資料來源。 這些資料類型包括資料表、資料實體、方法和列舉。
- 當必須在執行階段指定某些資料時，它支援可以定義為資料模型的資料來源的使用者輸入參數。
- 它支援將資料轉換為所需的組。 您還可以篩選、排序和加總資料，並附加透過類似於 Microsoft Excel 公式的設計邏輯計算欄位。 如需相關資訊，請參閱[電子報表 (ER) 中的公式設計工具](general-electronic-reporting-formula-designer.md)。

支援傳入電子文件的模型對應具有以下功能：

- 它可以使用不同的可更新資料元素作為目標。 這些資料元素包括資料表、資料實體和檢視表。 該資料可以透過來自電子文件的傳入資料進行更新。 在單個模型對應中可以使用多個目標。
- 當必須在執行階段指定某些資料時，它支援可以定義為資料模型的資料來源的使用者輸入參數。

為每個業務領域設計了一個資料模型組件，用作報表的統一資料來源。 統一資料來源將報表與資料來源的實體實現隔離開來。 該組件以使報表格式的初始設計和進一步維護更有效的形式表示特定領域的業務概念和函數。

## <a name="format-component"></a>格式組件

### <a name="format-components-for-outgoing-electronic-documents"></a>傳出電子文件的格式組件

格式組件是在執行階段產生的報表輸出方案。 一個配置由以下元素組成：

- 一種定義執行階段產生的傳出電子檔的結構和內容的格式。
- 資料來源，作為一組使用者輸入參數和使用選定模型對應的特定於領域的資料模型。
- 格式對應，作為格式資料來源的一組繫結，這些資料來源具有格式的各個元素，這些元素在執行階段指定資料流程和產生格式輸出的規則。
- 格式驗證，作為一組可設定的規則，在執行階段控制報表產生，具體取決於執行內容。 例如，可能有一條規則會停止產生廠商付款的輸出，並在缺少所選廠商的特定屬性 (例如銀行帳號) 時引發異常。

格式組件支援以下函數：

- 將報表輸出建立為各種格式的單個檔案，例如文字、XML、Microsoft Word 文件或工作表
- 分別建立多個檔案並封裝成 ZIP 檔案

格式組件允許您附加可在報表輸出中使用的特定檔案：

- Excel 活頁簿，其中包含可用作以 OPENXML 工作表格式輸出的範本的工作表
- Word 檔案包含可用作以 Microsoft Word 文件格式輸出的範本的文件
- 可以作為預定義檔案合併到格式輸出中的其他檔案

下圖顯示了這些格式的資料如何流動。

[![傳出格式組件的資料流程](./media/ER-overview-02.png)](./media/ER-overview-02.png)

若要執行單個 ER 格式設定並產生傳出電子文件，您必須識別格式設定的對應。

#### <a name="format-components-for-incoming-electronic-documents"></a>傳入電子文件的格式組件
格式組件是在執行階段匯入的傳入文件的方案。 一個配置由以下元素組成：

- 一種定義傳入的電子檔的結構和內容的格式，包含在執行階段匯入的資料。 格式組件用於解析各種格式的傳入文件，例如文字和 XML。
- 將單個格式元素繫結到特定於領域的資料模型的元素的格式對應。 在執行階段，資料模型中的元素指定資料流程和從傳入文件匯入資料的規則，然後將資料儲存在資料模型中。
- 格式驗證，作為一組可設定的規則，在執行階段根據執行環境控制資料匯入。 例如，可能有一條規則會停止匯入包含廠商付款的銀行對帳單的資料，並在缺少特定廠商的屬性 (例如廠商識別代碼) 時引發異常。

下圖顯示了這些格式的資料如何流動。

[![傳入格式組件的資料流程](./media/ER-overview-03.png)](./media/ER-overview-03.png)

若要執行單個 ER 格式設定以從傳入的電子文件匯入資料，您必須確定所需的格式設定對應，以及模型對應的整合點。 您可以將相同的模型對應和目的地與不同的格式一起用於不同類型的傳入文件。


## <a name="component-versioning"></a>組件版本設定

ER 組件支援版本設定。 提供以下工作流程來管理 ER 組件中的更改：

1. 最初建立的版本被標記為 **草稿** 版本。 此版本可以編輯並可用於測試執行。
2. **草稿** 版本可以轉換為 **已完成** 版本。 此版本可用於本地報表流程。
3. **已完成** 版本可以轉換為 **共用** 版本。 此版本在 Microsoft Dynamics Lifecycle Services (LCS) 上發布，可用於全球報表流程。
4. **共用** 版本可以轉換為 **中止** 版本。 可以刪除此版本。

具有 **已完成** 或 **共用** 狀態的版本可用於其他資料交換。 可以對具有這些狀態的組件執行以下動作：

- 該組件可以以 XML 格式序列化並以 XML 格式匯出為檔案。
- 該組件可以從 XML 檔案重新序列化，並作為 ER 組件的新版本匯入應用程式。

## <a name="component-date-effectivity"></a>組件日期有效性

ER 組件版本是有效日期的。 您可以為 ER 組件設定「生效日期」，以指定組件對報表流程生效的日期。 應用程式工作階段日期用於定義組件是否有效執行。 如果多個版本在特定日期有效，則最新版本用於報表流程。

## <a name="component-access"></a>組件存取

對 ER 格式組件的存取取決於國際標準化組織 (ISO) 國家/地區代碼的設定。 如果對於格式設定的選定版本，此設定為空，則可以在執行階段從任何公司存取格式組件。 如果設定包含 ISO 國家/地區代碼，則格式組件僅適用於為格式組件的 ISO 國家/地區代碼之一定義了主要地址的公司。

不同版本的資料格式組件可以有不同的 ISO 國家/地區代碼設定。

[!INCLUDE[footer-include](../../../includes/footer-banner.md)]

