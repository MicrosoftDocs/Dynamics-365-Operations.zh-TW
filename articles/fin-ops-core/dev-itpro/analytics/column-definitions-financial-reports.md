---
title: 財務報告中的欄定義
description: 本文提供有關欄定義的資訊。 欄定義是一個報告組件，用於定義報告中資料欄的內容。
author: ShylaThompson
ms.date: 10/10/2019
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: FinancialReports
audience: Application User
ms.reviewer: kfend
ms.custom: 106601
ms.assetid: 66e72a48-edab-4e9d-815f-596a1623c258
ms.search.region: Global
ms.author: aolson
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: Version 1611
ms.openlocfilehash: 199dceb91195a3488dd269786a8cd59811d8d828db686c3636e3d6320c77bbeb
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/05/2021
ms.locfileid: "8460286"
---
# <a name="column-definitions-in-financial-reports"></a>財務報告中的欄定義

[!include [banner](../includes/banner.md)]

本文提供有關欄定義的資訊。 欄定義是一個報告組件，或稱建構元素，用於定義報告中資料欄的內容。 與列定義一樣，基本欄定義可用於多種報表。

## <a name="create-and-modify-a-column-definition"></a>建立和修改欄定義

欄定義可以包含 2 到 255 資料欄。

### <a name="create-a-column-definition"></a>建立欄定義

1. 在 Report Designer 中的瀏覽窗格，點選 **欄定義**。
2. 在 **檔案** 選單上，點選 **新增**，然後點選 **欄定義**。
3. 新增欄定義的內容。

### <a name="open-a-column-definition"></a>打開欄定義

1. 在 Report Designer 中的瀏覽窗格，點選 **欄定義**。
2. 雙擊點選欄定義將其打開。

### <a name="add-a-column-to-a-column-definition"></a>將資料欄新增到欄定義

1. 在 Report Designer 中，點選 **欄定義**，然後打開要修改的欄定義。
2. 選取應插入新資料欄的資料欄。
3. 在 **編輯** 選單上，點選 **插入資料欄**。 新資料欄出現在您選擇的資料欄的左側。

### <a name="delete-a-column-from-a-column-definition"></a>從欄定義中將資料欄刪除

1. 在 Report Designer 中，點選 **欄定義**，然後打開要修改的欄定義。
2. 選取要刪除的資料欄。
3. 在 **編輯** 選單上，點選 **刪除資料欄**。

## <a name="contents-of-a-column-definition"></a>欄定義的內容
欄定義包括以下資訊：

- 列定義的描述資料欄
- 顯示來自財務資料的資料或基於欄定義中其他資料的計算的金額資料欄
- 格式化資料欄
- 屬性資料欄

此資訊出現在欄定義的以下區域中：

- 欄定義的標題區域包含報告中顯示的標題文字和格式。 標題可以套用於單個資料資料欄、跨越多個資料欄，或在有條件地套用於資料欄。 欄定義可以包含您所需任意多的資料欄標題資料列。

    > [!NOTE]
    > 資料欄標題適用於報告中的每一資料欄資料。 報告標題適用於整個報告。 您在報告定義的 **頁首和頁尾** 索引標籤定義報告頁首。

- 資料欄詳情資料列是欄定義中標題資料列下的資料列。 資料欄詳情列定義報告中包含的資訊。 下表資料列出並描述了資料欄詳情資料列。

    | 資料欄詳情資料列名稱                                                | 描述                                                                                            |
    |-----------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------|
    | 資料欄類型                                                           |  (必需) 指定資料欄中的資料類型。                                                     |
    | 帳冊代碼/屬性類別                                          | 針對 **FD** 和 **ATTR** 類型的資料欄指定財務資料資訊。                       |
    | 涵蓋的會計年度週期                                    | 針對 **FD** 類型的資料欄指定財務資料資訊。                                     |
    | 公式                                                               | 針對 **CALC** 類型的資料欄指定計算公式。                                        |
    | 資料欄格式覆寫列印控制前的資料欄寬額外空格 | 指定特殊格式選項。                                                                        |
    | 欄限制                                                   | 限制資料。                                                                                         |
    | 報表單位                                                        | 限制該資料欄，使其僅顯示指定報表單位的資料。                      |
    | 貨幣顯示貨幣篩選器                                      | 格式化貨幣。                                                                                       |
    | 維度篩選器                                                      | 指定篩選器以將資料限制為某些財務資料報表單位。                           |
    | 屬性篩選器                                                      | 指定篩選器以限制財務資料。                                                       |
    | 開始日期結束日期                                                   | 將財務資料限制為指定資料。                                                         |
    | 對齊                                                         | 左對齊、居中對齊或右對齊列定義中指定的說明文字。 |

## <a name="column-restrictions-in-a-column-definition"></a>欄定義中的欄限制
您可以使用欄限制來指定欄定義如何使用資料或計算資訊。 您還可以將報告欄限制為特定單位或特定日期。

> [!NOTE]
> **欄限制** 代碼覆寫在列定義中指派的任何衝突設定。

### <a name="column-restrictions-cell"></a>欄限制儲存格

**欄限制** 儲存格可以包含該資料欄限製或隱藏資訊的代碼，例如資料列格式化、詳情和金額。

#### <a name="add-a-column-restriction-in-a-column-definition"></a>在欄定義中新增欄限制

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選該資料欄的 **欄限制** 儲存格來限制。
3. 在 **欄限制** 對話方塊中，在清單中選取一個或多個代碼，然後點選 **確定**。

### <a name="column-restriction-codes"></a>欄限制代碼

下表描述了欄限制代碼。

| 欄限制代碼 | 描述 |
|-------------------------|-------------|
| SU                      | 隱藏資料欄的下橫線，其中已將下橫線命令 (**---**) 或雙下橫線命令 (**===**) 輸入在列定義中。 例如，您可能不想在百分比計算產生的金額畫底線。 |
| ST                      | 隱藏總計，以便僅在資料欄中顯示詳情 (例如，統計資料欄)。 |
| SD                      | 隱藏細節，這樣只有 **TOT** 和 **CAL** 資料列 (來自列定義) 顯示在資料欄中。 |
| DR                      | 將 **FD** 資料欄的金額限制為借方金額。 |
| CR                      | 將 **FD** 資料欄的金額限制為貸方金額。 |
| ADJ                     | 將資料欄中的金額限制為週期調整金額 (如果這些金額可用)。 |
| XAD                     | 限制資料欄中的金額，以便排除週期調整金額。 |
| PT                      | 限制資料欄中的金額，以便僅包含已過帳的交易 (如果這些交易可用)。 |
| UPT                     | 限制資料欄中的金額，以便僅包含未過帳的交易 (如果這些交易可用)。<p><strong>注意事項：</strong>並非所有資料提供者都支援未過帳交易。 </p> |

### <a name="restrict-a-column-to-a-reporting-unit"></a>將欄限制為報表單位

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選該資料欄的 **報表單位** 儲存格來限制。
3. 在 **報表單位選擇** 對話方塊的 **報表樹狀結構定義** 清單中，選取一個樹狀結構。
4. 展開或摺疊單位清單，選取報表單位，然後點選 **確定**。

## <a name="format-column-headers"></a>格式化資料欄標題
您可以新增、修改和刪除顯示在報告資料欄頂部的標題。 您還可以設定條件式跨越資料欄標題，根據欄定義中的 **週期** 資料欄和報表定義中的 **基準週期**。 基準週期函數可幫助您在建立滾動預測報告時節省時間。

### <a name="create-and-manage-column-headers"></a>建立和管理資料欄標題

您可以使用 **資料欄標題** 對話方塊來新增、修改和刪除顯示在報告資料欄頂部的標題。 下表描述了 **資料欄標題** 對話方塊中的資料欄。

| 欄位                 | 描述 |
|-----------------------|-------------|
| 資料欄標題文字    | 此文字出現在資料欄標題中。 您可以直接在此資料欄中輸入文字，或點選 **插入自動圖文集** 選取每次產生報告時更新資料欄標題的選項。 若要包含多個自動文字代碼，請再次點選 **插入自動圖文集**，然後點選清單中的另一個代碼。 |
| 格式選項        | 將格式套用於資料欄標題，例如方塊或底線。 |
| 展開自展開至 | 定義資料欄或標題文字適用的資料欄。 |
| 對齊         | 指定資料欄標題文字應如何對齊在 **展開自** 和 **展開至** 資料欄中指定的資料欄或資料欄範圍。 |

### <a name="create-a-column-header"></a>建立資料欄標題

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選標題儲存格。
3. 在 **資料欄標題** 對話方塊中，輸入資料欄標題文字。 或者，點選 **插入自動圖文集**，然後選取一個選項。
4. 在 **格式選項** 欄位，選取標題格式。
5. 在 **展開自** 資料欄中，輸入資料欄標題應重新命名之資料欄的字母。 在 **展開至** 資料欄中，輸入資料欄標題應結束命名之資料欄的字母。
6. 在 **對齊** 下方，選取要左對齊、居中對齊還是右對齊的資料欄標題文字。
7. 點選 **確定**。

### <a name="add-a-column-header-row"></a>新增資料欄標題資料列

1. 在 Report Designer 中，打開欄定義做修改。
2. 在標題資料列中選取一個儲存格。
3. 在 **編輯** 選單上，點選 **插入資料列**。 新資料列將插入到您在步驟 2 中選取的資料列上方。

> [!NOTE]
> 如果報表上有四資料列或更多資料列報表標題，則在將報表匯出到 Excel 工作表時標題將重疊。 若要檢視報表上的所有標題，請增加報表定義中的上邊距。

### <a name="delete-a-column-header-row"></a>刪除資料欄標題資料列

1. 在 Report Designer 中，打開欄定義做修改。
2. 在標題資料列中，選取要刪除的儲存格。
3. 在 **編輯** 選單上，點選 **刪除資料列**。

### <a name="create-an-automatically-generated-header"></a>建立自動產生的標題

Report Designer 可以根據自動文字字碼自動產生資料欄標題。 自動文字字碼是每次產生報告時都會更新的變量。 任何資料欄標題都可以包含這些代碼以指定可以變化的報告資訊，例如日期或週期編號。 因此，您可以將一個欄定義用於多個報告定義、時間段和報表樹狀結構。 因為自動文字字碼依賴於欄定義的詳情資料列中的日曆資訊，所以它們僅支援 **CALC** 和 **FD** 欄。 自動文字字碼在資料欄標題儲存格中的顯示方式會影響該資訊在報告中的顯示方式。 在 **資料欄標題** 對話方塊中，自動文字字碼以混合大小寫出現。 因此，該文字在報告中以混合大小寫形式出現。 例如，在標準年度中，**\@CalMonthLong** 解決了月份 **7** 為 **七月** 的問題。 如果月份的名稱應該是大寫的 (例如 **七月**)，則在 **資料欄標題文字** 資料欄中輸入大寫字元的自動文字字碼。 例如，輸入 **\@CALMONTHLONG**。 您可以混合使用代碼和文字。 例如，您輸入以下標題文字：**Period\@FiscalPeriod-\@FiscalYear from\@StartDate to\@EndDate**。 產生的報告標題類似於以下文字：**Period 1-02 from 01/01/02 to 01/31/02**。

> [!NOTE]
> 某些文字的格式 (例如長日期) 取決於您在伺服器上的區域設定。 若要更改這些設定，請點選 **開始** 按鈕，點選 **控制面板**，然後點選 **地區和語言**。 下表列出了資料欄標題提供的自動圖文集選項。


| 自動圖文集選項和代碼                | 描述 |
|-----------------------------------------|-------------|
| 月份名稱 (@CalMonthLong)              | 在資料欄標題中列印現行月份的名稱。 如果您決定將報告中的金額四捨五入為千、百萬或十億，或者如果您將報告中的資料欄寬設定為少於九個字元，則月份名稱將縮寫為前三個字元。 |
| 縮寫月份名稱 (@CalMonthShort) | 列印所選會計期間的月份縮寫名稱。 |
| 週期編號 (@FiscalPeriod)           | 列印為該資料欄標識的會計期間的數字形式。 如果資料欄跨越多個句點，則列印範圍中的最後一個句點。 |
| 週期描述 (@FiscalPeriodName)  | 列印財務資料中標識的會計期間描述。 |
| 會計年度 (@FiscalYear)               | 以數字形式列印資料欄的會計年度。 |
| 標準年份 (@CalYear)                | 以數字形式列印的標準年度。 |
| 開始日期 (@StartDate)                 | 列印資料欄的開始日期。 |
| 結束日期 (@EndDate)                     | 列印資料欄的結束日期。 |
| 樹狀結構中的單元名稱 (@UnitName)         | 如果您將欄限制為報表樹狀結構的特定單元，請在資料欄標題中列印單元名稱。 |
| 單元描述 (@UnitDesc)            | 如果您將欄限制為報表樹狀結構的特定單元，請在資料欄標題中列印單元描述。 |
| 帳簿代碼 (@BookCode)                   | 列印在資料欄中指定的帳簿代碼。 |
| 空行 (@Blank)                     | 在資料欄標題中插入一個空行。 |

### <a name="create-a-conditional-spanning-header"></a>建立條件式跨欄標題

條件式跨資料欄標題可以跨越基於特定週期資料的多個資料欄。 例如，如果您有會計年度的預算報告，並且想要顯示過去幾個月的實際預算以及未來幾個月的預計預算，您可以使用條件式跨欄標題來自動更新報告標題。 建立條件式跨欄標題時，請注意以下情況：

- 任何在開始條件 (**展開自** 欄位) 前相符的停止條件 (**展開至** 欄位) 都會被忽略。 例如，B 欄將定義為基礎+1 的條件展開至 BASE、BASE 在 C 欄中，而基礎+1 在 D 欄中。在這種情況下，C 欄中的停止條件會被忽略，並且從 D 欄開始列印標題。
- 如果您指定重疊的資料欄標題，它們會在報表上列印時重疊。 報告已產生，但以下警告出現在 **報告佇列狀態** 資料欄：「使用 Base 的資料欄標題與其他資料欄標題相交，可能導致文字重疊。」 例如，B 欄的標題定義為 B 到基礎+1，而 D 欄的標題定義為基礎+1 到 F。在這種情況下，標題相互重疊列印且無法讀取。 每當 BASE 用於 **展開自/展開至** 定義，請務必檢視產生的報告，查看標題是否重疊。
- 如果您在 No Print (**NP**) 欄的展開定義指定 BASE，無論欄定義中定義了什麼，它都會被忽略。 本質上，這種情況與不建立資料欄標題定義相同。
- 對於條件式列印資料欄 (**P&lt;B**，**P&gt;=B**)，條件式跨資料欄標題的行為類似於任何常規資料欄標題定義。 例如，如果條件為 False，則與展開條件相符的任何後續資料欄都會開始列印標題。

#### <a name="create-a-conditional-spanning-header"></a>建立條件式跨欄標題

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選標題儲存格。
3. 在 **資料欄標題** 對話方塊中，輸入資料欄標題文字。 或者，點選 **插入自動圖文集**，然後選取一個選項。
4. 在 **格式選項** 欄位，選取標題的格式化樣式。
5. 指定相對於產生報告時指定的基準週期的週期。 在 **展開自** 和 **展開至** 欄位，輸入以下其中一個值：**BASE**、**BASE-X** 或 **BASE+X**，其中 X 是基準週期的週期數。 例如，如果您在 **展開自** 資料欄中輸入 **BASE**，條件式跨資料欄標題文字會在資料欄為標題中開始，其中報表定義的 **基準週期** 值等於欄定義的 **週期** 值。 它在於 **展開至** 資料欄中表明的資料欄中結束。 因此，如果工作表是 BASE 到 M，並且報表定義的 **基準週期** 值為 **4**，標題從時間段設定為 **4** 的資料欄開始並在 M 欄結束。標題僅在列印資料欄上停止和開始。
6. 在 **對齊** 下方，選取要左對齊、居中對齊還是右對齊的資料欄標題文字。
7. 點選 **確定**。

#### <a name="example-of-a-conditional-spanning-header"></a>條件式跨欄標題的範例

使用者正在為動態的六個月預測建立報告。 使用者希望在包含實際資料的資料欄上列印單字「Actual」 (實際)，並且在包含預算預測的資料欄上列印單字「Budget」 (預算)。 報告執行的每個月，都會多出一個實際資料欄和少一個預算資料欄。 儘管使用者可以在每次產生報告時手動修改欄定義以調整標題，但為了節省時間和精力，使用者決定建立條件式跨資料欄標題，每次執行報告時都會在適當的資料欄上自動建立標題。 使用者打開 Report Designer，點選在瀏覽窗格中的 **欄定義**，並打開報告的欄定義。 然後使用者輸入以下資訊。 報表定義中的基準週期為 4。

|      格式         |  A   | B             | C             | D             | E             | F             | G             | H             | I             | J             | K             | L             | M             |
|---------------------|------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|---------------|
| 標題 1            |      | 實際的        | 預算        |               |               |               |               |               |               |               |               |               |               |
| 標題 2            |      | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong | @CalMonthLong |
| 標題 3            |      |               |               |               |               |               |               |               |               |               |               |               |               |
| 資料欄類型         | DESC | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            | FD            |
| 帳簿代碼/屬性 |      | 實際        | BUDGET2012    | 實際        | BUDGET2012    | 實際        | BUDGET2012    | 實際        | BUDGET2012    | 實際        | BUDGET2012    | 實際        | BUDGET2012    |
| 會計年度         |      | 基準          | 基準          | 基準          | 基準          | 基準          | 基準          | 基準          | 基準          | 基準          | 基準          | 基準          | 基準          |
| 期間              |      | 1             | 1             | 2             | 2             | 3             | 3             | 4             | 4             | 5             | 5             | 6             | 6             |
| 涵蓋週期     |      | 定期      | 定期      | 定期      | 定期      | 定期      | 定期      | 定期      | 定期      | 定期      | 定期      | 定期      | 定期      |
| 資料欄寬        | 30   | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            | 10            |
| 列印控制       |      | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        | P&lt;=B       | P&gt;B        |

使用者雙擊點選 B 欄中的資料欄標題儲存格以打開 **資料欄標題** 對話方塊，並輸入以下資訊。

| 欄位              | 值                 |
|--------------------|-----------------------|
| 資料欄標題文字 | 實際的                |
| 插入自動圖文集    | 不進行選擇。 |
| 格式選項     | 箱                   |
| 對齊      | 不進行選擇。 |
| 展開自        | B                     |
| 展開至          | 基準                  |

輸入資訊後，使用者點選 **確定**。 使用者之後雙擊點選 C 欄中的資料欄標題儲存格以打開 **資料欄標題** 對話方塊，並輸入以下資訊。

| 欄位              | 值                 |
|--------------------|-----------------------|
| 資料欄標題文字 | 預算                |
| 插入自動圖文集    | 不進行選擇。 |
| 格式選項     | 箱                   |
| 對齊      | 不進行選擇。 |
| 展開自        | 基礎+1                |
| 展開至          | M                     |

現在，每次此報告產生時，將會在包含實際資料的資料欄上列印單字「Actual」 (實際)，並且在包含預算預測的資料欄上列印單字「Budget」 (預算)。 此外，每個月都會調整資料欄數。

## <a name="apply-column-justification"></a>套用資料欄對齊
**對齊** 儲存格用於將對齊格式套用於報表中的描述資料欄。 此選項僅影響資料欄描述，而不影響實際值。

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選 **對齊** 儲存格。
3. 在清單中選取下列其中一個值：

    - **無** – 不是用任何對齊。
    - **左** – 將資料欄描述靠左對齊。
    - **居中** – 將資料欄描述居中對齊。
    - **右** – 將資料欄描述靠右對齊。

## <a name="add-special-formatting-options"></a>新增特殊格式化選項
在欄定義中，格式化的資料欄詳情資料列將特殊格式套用於選定資料欄。 雖然有些 **列印控制** 選項和 **欄限制** 選項特定於 **FD** 資料欄，大多數選項適用於所有資料欄類型。 欄定義中指定的格式會覆寫報表定義中指定的格式。 但是，列定義中指定的格式會覆寫欄定義中指定的格式。 以下資料列被視為格式化資料列：

- 資料欄寬
- 資料欄前的額外空格
- 格式/貨幣覆寫
- 列印控制

### <a name="changing-the-column-width"></a>更改資料欄寬

**資料欄寬** 儲存格指定用於書面報告上此資料欄寬的字元數。 資料欄寬對於包含金額 (**CALC**、**WKS**，或 **FD** 類型) 、描述 (**DESC** 類型的資料欄) 或填入 (**FILL** 類型的資料欄) 的資料欄很重要。 在預設情況下，選取 **自動調整** 選項，以便自動調整每資料欄的寬度以適應內容。

#### <a name="specify-the-width-of-a-column-on-a-report"></a>指定報表上的資料欄寬

1. 在 Report Designer 中，打開欄定義做修改。
2. 在 **資料欄寬** 儲存格，輸入資料欄寬的空格數。 任何資料欄的最大寬度為 255 個字元 (此數字包括美分、逗號和括號)。 或者，若要使 Report Designer 能夠根據儲存格內容為資料欄選取適當的寬度，請雙擊點選 **資料欄寬** 儲存格，然後底選 **自動調整**。

### <a name="add-space-between-columns"></a>在資料欄之間新增空格

**資料欄前的額外空格** 儲存格指定欄定義中某一資料欄與相鄰資料欄之間的分隔符號的寬度。 **資料欄前的額外空格** 設定影響資料欄的所有資料欄詳情資料列，但不影響資料欄標題資料列。 使用此選項可分隔資料欄組或在描述前新增幾個空格，以便描述資料欄從報表上靠左對齊的標題縮進。 每資料欄之間的預設空格數是兩個。 您可以在報表定義中的 **設定** 索引標籤上更改此設定。

#### <a name="specify-the-space-between-columns"></a>指定資料欄之間的空間格

1. 在 Report Designer 中，打開欄定義做修改。
2. 在 **資料欄前的額外空格** 儲存格，輸入要在資料欄之間插入的空格數。

### <a name="specify-a-format-currency-override"></a>指定/格式貨幣覆寫

**格式/貨幣覆寫** 儲存格指定資料欄中小數點、貨幣和百分比金額的格式。 此格式會覆寫在報告定義或系統預設值中指定的任何格式。

#### <a name="assign-a-format-currency-override-to-a-report-column"></a>將格式貨幣覆寫指派給報告資料欄

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選 **格式/貨幣覆寫** 金額資料欄中的儲存格。
3. 在 **格式覆寫** 對話方塊中，選取格式選項。

### <a name="add-a-print-control-code"></a>新增列印控制碼

**列印控制** 儲存格可以包含調整資料欄的顯示或列印特性的代碼。 有兩種類型的列印控制碼：常規列印控制碼和條件式列印控制代碼。

#### <a name="regular-print-control-codes"></a>一般列印控制碼

| 列印控制碼 | 換算                                     | 描述 |
|--------------------|-------------------------------------------------|-------------|
| NP                 | 非印刷                                     | 從列印的報告和計算中排除此資料欄中的金額。 若要在計算中包含非列印資料欄，請直接在計算公式中參考該資料欄。 例如，非列印資料欄 C 包含在以下計算中：**B+C+D**。 但是，非列印資料欄 C 不包含在以下計算中：**B:D**。 |
| XCR                | 如果資料列的典型餘額是貸方，則更改符號 | 建立任何不利差異 (例如收入不足或費用超支) 一直為負數的預算或比較報告。 如果某一資料列的典型餘額是貸方 (由列定義中的 **正常餘額** 資料欄中的 **C** 識別)，則將此代碼套用於 **CALC** 欄，以沖銷該資料欄金額的符號。<p><strong>注意事項：</strong>針對通常帶有貸方餘額的 <strong>TOT</strong> 資料列和 </strong>CAL</strong> 資料列，請務必將 <strong>C</strong> 輸入至列定義中的<strong>正常餘額</strong>資料欄。</p> |
| X0                 | 如果全為零或空白，則隱藏資料欄          | 如果某資料欄中的所有儲存格為空白或包含零，則從報告中排除 **FD** 資料欄。 |
| SR                 | 隱藏進位                               | 防止此資料欄中的金額被四捨五入。 |
| XR                 | 隱藏上捲累積                                 | 隱藏上捲累積。 如果該報表使用報表樹狀結構，則此資料欄中的金額不會上捲累積到後續父系節點中。 |
| RP                 | 在每一頁上重複資料欄                      | 在報告的每一頁上重複指定的資料欄。 例如，您可以使用 **RP** 資料列印控制碼以加入在每一頁上提取資料列代碼 **ROW** 資料欄。 |
| WT                 |  自動換列                                      |  如果資料欄中的文字太長而無法容納空格，請將自動換列以保留資料欄中的所有文字。 |

#### <a name="conditional-print-control-codes"></a>條件式的列印控制碼

| 條件式列印控制代碼 | 描述                                                                             |
|--------------------------------|-----------------------------------------------------------------------------------------|
| (無)                         | 清除條件式列印選擇。                                                  |
| P&lt;B                         | 僅當週期少於基準週期時才顯示指定資料欄。             |
| P&gt;B                         | 僅當週期多於基準週期時才顯示指定資料欄。             |
| P=B                            | 僅當週期等於基準週期時才顯示指定資料欄。              |
| P&lt;=B                        | 僅當週期少於或等於基準週期時才顯示指定資料欄。 |
| P&gt;=B                        | 僅當週期多於或等於基準週期時才顯示指定資料欄。 |

#### <a name="add-print-control-codes-to-a-report-column"></a>將列印控制代碼新增到報表資料欄

1. 在 Report Designer 中，打開欄定義做修改。
2. 按兩下點選 **列印控制** 儲存格。
3. 在 **列印控制** 對話方塊中，在 **選取列印控制選項** 清單中選取代碼。 若要選擇多個代碼，請在選取代碼時按住 Ctrl 鍵。
4. 在 **條件式列印選項** 欄位選取選項。 在預設的情況下，**(無)** 已選取。 您一次只能選取條件式列印代碼。
5. 按一下 **確定**。

> [!TIP]
> 您也可以直接在 **列印控制** 儲存格輸入列印代碼。 使用逗號分隔多個列印控制碼。

## <a name="column-types"></a>資料欄類型
報告中每資料欄包含的資訊類型由欄定義中的 **資料欄類型** 資料列。 每個欄定義必須至少包含一個描述 (**DESC**) 欄和一個金額 (**FD**、**WKS**，或 **CALC**) 欄。

> [!NOTE]
> 資料欄類型代碼不適用於所有會計系統。 如果您選取對您會計系統無效的類型，則該資料欄在報告中為空白。

### <a name="specify-a-column-type"></a>指定資料欄類型

1. 在 Report Designer 中，打開欄定義做修改。
2. 在相應的資料欄中，雙擊點選 **資料欄類型** 資料列。
3. 在清單中選取資料欄類型。 下表描述了不同的資料欄類型。

    <table>
    <thead>
    <tr>
    <th>資料欄類型代碼</th>
    <th>描述</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>FD</td>
    <td>在使用列定義中的<strong>連結到財務維度</strong>資料欄時顯示財務資料。 當您選取 <strong>FD</strong> 資料欄類型，為以下資料列自動指定預設設定： <ul>
    <li><strong>帳簿代碼/屬性類別：</strong>ACTUAL</li>
    <li><strong>帳簿代碼/屬性類別：</strong>ACTUAL</li>
    <li><strong>會計年度：</strong>BASE</li>
    <li><strong>週期：</strong>BASE</li>
    <li><strong>涵蓋週期：</strong>PERIODIC</li>
    <li><strong>資料欄寬：</strong>14</li>
    </ul>
您可以更改這些預設設定。</td>
    </tr>
    <tr>
    <td>CALC</td>
    <td>顯示在<strong>公式</strong>儲存格中指定的簡單或複雜計算的結果。 如需相關資訊，請參閱<a href="advanced-formatting-options-financial-reporting.md">財務報告中的進階格式選項</a>。</td>
    </tr>
    <tr>
    <td>DESC</td>
    <td>顯示列定義中的資料列描述。 雖然該描述資料欄通常是報告的第一資料欄，但它可以位於任何位置。</td>
    </tr>
    <tr>
    <td>列</td>
    <td>從列定義中的<strong>資料列代碼</strong>資料欄顯示各個財務資料列的資料列代碼。 如需相關資訊，請參閱<a href="row-definitions-financial-reporting.md">財務報告中的列定義</a>。</td>
    </tr>
    <tr>
    <td>ACCT (科目代碼)</td>
    <td>顯示財務資料區段值或適用於每一資料列的維度值。 對於科目和交易明細報告，列印完全合格的科目 (例如，<strong>110140-070-0101</strong>)。 如果範圍已在相關列定義中的<strong>連結到財務維度</strong>資料欄指定，該範圍會括在方括號中並被視為單個值 (例如，<strong>[110140:110700]-070-[0101:0200]</strong>)。 對於由多筆科目組合的財務報表和高層級報表，將資料列印來自列定義的財務資料連結 (例如，<strong>1100:1200</strong>)。</td>
    </tr>
    <tr>
    <td>FILL</td>
    <td>用單引號括起來的字元來填入儲存格。 如果不輸入字元，則該資料欄為空白。 例如，若要使用省略符號 (...) 填滿資料欄，請輸入 <strong>FILL</strong> <strong>'.'</strong>.</td>
    </tr>
    <tr>
    <td>PAGE</td>
    <td>在報表中插入垂直分頁符號。 <strong>頁面</strong>資料欄右側的資料欄出現在不同的頁面上。</td>
    </tr>
    <tr>
    <td>ATTR</td>
    <td>如果您的會計系統支援屬性，請在資料欄中顯示科目或交易屬性。 必須套用於單個完整科目的屬性從財務資料中擷取基礎科目或交易資訊。 科目級屬性顯示來自科目的資料，而交易級屬性顯示在過帳交易時發生的資料。 如果您選取 <strong>ATTR</strong> 作為資料欄類型，在欄定義的<strong>帳簿代碼/屬性類別</strong>詳情資料列指定屬性類別。</td>
    </tr>
    </tbody>
    </table>

### <a name="financial-dimensions-column"></a>財務維度資料欄

以下 **欄定義** 列定義適用於有 **FD** (財務維度的金額) 的資料欄類型的資料欄。

#### <a name="book-codeattribute-category-cell"></a>帳簿代碼/屬性類別儲存格

**帳簿代碼/屬性類別** 儲存格識別 **FD** 資料欄中資料的帳簿代碼。 欄定義可以加入多個實際、預算和統計資料欄。 欄定義還可以顯示不同的週期，例如現行或年初至今，以及不同的金額。 帳簿代碼清單反映了已在您財務資料中建立的實際、預算和統計 (非財務) 選項。

#### <a name="fiscal-year-cell"></a>會計年度儲存格

**會計年度** 儲存格識別該資料欄應包括的會計年度。 年份可以是相對於產生報告時指定的基準年。 可以使用以下選項。

| 選項  | 描述                                                                                                                  |
|---------|------------------------------------------------------------------------------------------------------------------------------|
| 基準    | 使用在報告時指定的基準年。                                                                          |
| BASE+\# | 使用基準年後 \# 年的年份。 例如，若要使用基準年之後的第三年，請輸入 **BASE+3**。 |
| BASE-\# | 使用基準年前 \# 年的年份。 例如，若要使用上一年，請輸入 **BASE-1**。                 |
| \#      | 輸入實際會計年度。                                                                                                |

#### <a name="period-cell"></a>週期儲存格

**週期** 儲存格識別該資料欄應包括的會計期間。 週期可以是相對於產生報告時指定的基準週期。 可以使用以下選項。

| 選項          | 描述 |
|-----------------|-------------|
| 基準            | 使用基準週期。 |
| BASE+\#         | 使用基準週期後 \# 段週期的週期。 例如，若要使用基準週期之後的第三週期，請輸入 **BASE+3**。 |
| BASE-\#         | 使用基準週期前 \# 段週期的週期。 例如，若要使用上一週期，請輸入 **BASE-1**。 |
| BASE-\#:BASE    | 使用多個週期，從基準週期之前的幾個週期到基準週期。 例如，若要使用前三個週期和基準週期，請輸入 **BASE-3:BASE**。 |
| BASE:BASE+\#    | 使用多個週期，從基準週期到基準週期後的幾個週期。 例如，若要使用基準週期和以下兩個週期，請輸入 **BASE:BASE+2**。 |
| BASE-\#:BASE+\# | 使用多個週期，從基準週期之前的幾個週期到基準週期之後的幾個週期。 例如，若要使用前三個期間、基準週期，以及以下兩個週期，請輸入 **BASE-3:BASE+2**。 |
| 1:BASE          | 使用多個期間，從第一週期到基準週期。 |
| \#              | 一律使用特定的週期編號。 我們不建議您使用此選項，因為它會減少欄定義的靈活性。 |
| \#：\#           | 一律使用特定的週期範圍。 我們不建議您使用此選項，因為它會減少欄定義的靈活性。 |

您可以在任何期間規範中超越會計年度邊界，並且可以在一系列期間中混合年份。 例如，您將週期指定為 **BASE-5** (代表過去六個週期) 並執行基準週期為 2 的報表。 在這種情況下，報表顯示指定會計年度的前兩個週期和上一會計年度的後四個週期的資料。

### <a name="specify-the-periods-for-an-fd-column"></a>指定 FD 資料欄的週期

1. 在 Report Designer 中，打開欄定義做修改。
2. 在 **FD** 資料欄中，雙擊點選 **週期** 資料列中的儲存格，然後在清單中選取一個選項。
3. 在瀏覽窗格上方的公式欄中，或在 **週期** 儲存格，完成公式。 將任何數字符號 (\#) 替換為適當的值。

#### <a name="periods-covered-cell"></a>涵蓋週期儲存格

**涵蓋週期** 儲存格識別該資料欄應顯示的金額。 此金額是相對於 **會計年度** 和資料欄的 **週期** 儲存格。 可以使用以下選項。

| 選項      | 描述                                                                 |
|-------------|-----------------------------------------------------------------------------|
| 定期    | 顯示現行週期或週期範圍內的活動總和。 |
| PERIODIC/BB | 顯示現行週期或週期範圍內的期初餘額。   |
| YTD         | 顯示年初至今活動的總和。                               |
| YTD/BB      | 顯示當年的期初餘額。                                 |

### <a name="specify-the-periods-that-are-covered-for-an-fd-column"></a>指定涵蓋 FD 資料欄的週期

1. 在 Report Designer 中，打開欄定義做修改。
2. 在 **FD** 資料欄中，雙擊點選 **涵蓋週期** 資料列中的儲存格，然後在清單中選取一個選項。

### <a name="attribute-filter-in-a-column-definition"></a>欄定義中的屬性篩選器

屬性是進一步定義科目或交易的財務資料值。 科目屬性包括 **資產**、**責任**、**收入**，以及 **費用**。 交易屬性包括 **交易描述** 和 **交易申請日期**。 屬性支援可能在 Microsoft Dynamics ERP 系統之間有所差異。 **屬性篩選器** 儲存格限制 **FD** 資料欄的資料以指定屬性類別的特定值或範圍。 雖然此函數可以與 **ATTR** 欄一起使用，**ATTR** 欄不是必需的。 在 **FD** 資料欄中，報告將從屬性篩選器中包含的科目或交易有限制。

> [!NOTE]
> 若要查看您的 ERP 系統支援哪些屬性，請參閱您系統的整合指南。

#### <a name="apply-an-attribute-filter-for-an-fd-column-on-a-report"></a>為報表上的 FD 資料欄套用屬性篩選器

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選 **FD** 資料欄的 **屬性篩選器** 儲存格。
3. 在 **屬性篩選器** 對話方塊中，雙擊點選 **屬性** 資料欄中的儲存格，然後選取過濾器類型。
4. 若要進一步限制結果，請在 **From** 和 **To** 資料欄輸入範圍。 **From** 儲存格必須包含一個值。
5. 按一下 **確定**。

#### <a name="example-of-an-attribute-filter"></a>屬性篩選器範例

以下範例顯示了在 **帳簿代碼/屬性類別** 資料列中有科目屬性的部分資料欄描述。 此資料欄的屬性篩選器指定要包含在報告中的值的範圍。

|      篩選                  | A    | B                   |
|------------------------------|------|---------------------|
| 資料欄類型                  | DESC | FD                  |
| 帳冊代碼/屬性類別 |      | 實際              |
| 會計年度                  |      | 基準                |
| 期間                       |      | 1:BASE              |
| 涵蓋期間              |      | 定期            |
| ...                          |      |                     |
| 資料欄寬                 | 30   |                     |
| ...                          |      |                     |
| 屬性篩選器             |      | 參考=\[01:10\] |

### <a name="dimension-filter-in-a-column-definition"></a>欄定義中的維度篩選器

維度篩選器用於限制 **FD** 資料欄來指定維度值。 過濾器可以包括單個維度、一系列維度或一組維度。 過濾器還可以包括維度值集。 因為維度值可能會有所不同，..\\financial-dimensions\\維度型的系統不必對應於確切的長度。 無論報告是否包含報表樹狀結構，都會套用過濾器。 您可以在任何位置使用萬用字元 (\* or ?)。 當您指定多個科目時，請在科目之間放置逗號，如下範例所示：+科目=\[ 1200\]、+科目=\[ 1100\]、部門=\[ 01？\] 若要接收特定科目的所有部門，您可以從維度篩選器中排除部門維度。 例如，以下兩個維度篩選器的處理方式相同：

- +科目=\[1100\]，部門
- +科目=\[1100\]

您還可以使用英數字元的任意組合進行精確比對，並且可以定義部分維度。 例如，**位置 =\[ 10\*\]** 包括以 10 開頭的所有位置維度值。

#### <a name="apply-a-dimension-filter-for-a-column-on-a-report"></a>為報表上的資料欄套用維度篩選器

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選 **FD** 資料欄的 **維度篩選器** 儲存格。
3. 在 **維度** 對話方塊，輸入要套用的過濾器。
4. 按一下 **確定**。

### <a name="format-a-multiple-currency-report-in-a-column-definition"></a>在欄定義中格式化多貨幣報告

多貨幣報告可以以分類帳的記帳貨幣顯示金額、分類帳的報告、原始交易貨幣或換算的報表貨幣。 公司的記帳貨幣在分類帳安裝中定義。 不要將此設定與作業系統的區域選項設定混淆，您可以在其中設定報告中使用的預設貨幣符號。 欄定義中提供了以下與貨幣相關的儲存格：

- **貨幣顯示** – 指定顯示交易的貨幣類型 (會計、報告、交易或已換算的報告)。 換算為報表貨幣的函數有時稱為貨幣換算。 貨幣換算是一種報告總帳金額的能力，以可能不是公司函數或報表貨幣或交易輸入貨幣的貨幣列出。
- **貨幣過濾器** – 指定貨幣過濾器。 只有以選定貨幣輸入的交易才會顯示在報告中。

> 
若要確定公司的記帳貨幣，請執行以下步驟。

1. 在 Report Designer 中，在 **公司** 選單上，點選 **公司**。
2. 在 **公司** 對話方塊，選取一間公司，然後點選 **檢視**。
3. 在 **檢視公司** 對話方塊中，在 **區域選項** 下方，您可以查看為所選公司定義的貨幣。

#### <a name="specify-the-currency-on-a-multiple-currency-report"></a>在多幣種報告中指定貨幣

1. 在 Report Designer 中，打開欄定義做修改。
2. 雙擊點選在相應 **FD** 資料欄中的 **貨幣顯示**，然後選取用於顯示貨幣資訊的選項：**分類帳科目貨幣**、**分類帳報告**、交易貨幣，或選取換算為不同的報表貨幣。
3. 雙擊點選相應 **FD** 資料欄中的 **貨幣過濾器** 儲存格，然後在清單中選取適當的貨幣代碼。 只有以此貨幣輸入的交易才會顯示在報告中。


### <a name="example-for-currency-display-and-currency-filter-cells"></a>貨幣顯示和貨幣過濾器儲存格的範例

使用者在其欄定義中進行了以下貨幣選擇：

- **貨幣過濾器：** 日圓
- **貨幣顯示：** 來自分類帳的記帳貨幣 (美元)

由於選取了貨幣過濾器，報告僅納入以日圓 (JPY) 輸入的交易。 由於選取了貨幣顯示，報表以記帳貨幣美元 (USD) 顯示這些交易。

#### <a name="currency-filter-and-currency-display-combinations"></a>貨幣過濾器和貨幣顯示組合

下表顯示了由於選擇了 **貨幣顯示** 和 **貨幣過濾器** 儲存格中的各種選項群組合，可能出現的報告結果。 函數性貨幣為美元。


| 貨幣顯示儲存格                        | 貨幣過濾器儲存格 | 報告結果 |
|----------------------------------------------|----------------------|---------------|
| 交易貨幣                 | **日圓**              | **Y6,000** – 結果僅顯示以日圓輸入的交易。 |
| 來自分類帳的記帳貨幣 | **日圓**              |**60 美元** – 結果僅顯示以日圓輸入的交易並以美元顯示這些交易。<p><strong>注意事項：</strong>匯率約為每美元 100 日圓。</p> |
| 來自分類帳的記帳貨幣 | 空白                | **2,310 美元** – 結果以分類帳中指定的記帳貨幣顯示所有資料。<p><strong>注意事項：</strong>此金額是記帳貨幣的所有交易的總和。</p> |
| 交易貨幣                 | 空白                | **2,250 美元** – 結果以執行交易的貨幣顯示所有金額。 這代表總計將來自不同貨幣的金額相加。 |

### <a name="calculation-column-in-a-column-definition"></a>欄定義中的計算資料欄

欄定義中的 **CALC** 列類型支援 **公式** 儲存格中的複雜計算，並且可以包括 **+**、**-**、**\**_，和*/** 運算子，以及 **IF/THEN/ELSE** 陳述式。 計算資料欄也可以參考任何其他資料欄，甚至是後續資料欄。 此外，計算資料欄還可以包括會計年度和週期以支援資料欄的標題。 計算公式最長可達 1,024 個字元。 若要將計算結果表示為百分比，請使用特殊格式覆寫。

> [!NOTE]
> 計算公式的結果不包括非列印資料欄範圍內的值。 例如，**A:D** 列印 **0** (零)，而 **A+B+C** 用於非列印值計算值。

#### <a name="operators-in-calculation-columns"></a>計算資料欄中的運算子

若要加、減、乘或除資料欄，請按計算順序輸入資料欄字母，然後使用適當的運算子分隔每個資料欄字母。 下表說明了可以在計算資料欄中使用的運算子。

| 運算子 | 計算範例 | 描述 |
|----------|---------------------|-------------|
| +        | A+C                 | 將 A 欄中的金額新增到 C 欄中的金額。 |
| :        | A:C A:C-D           | 新增一系列連續的資料欄。 例如，公式 **A:C** 將 A 到 C 欄的總和相加，以及公式 **A:C-D** 將 A 到 C 欄的總和相加，然後減去 D 欄中的金額。 |
| -        | A-C                 | 從 C 欄的金額中減去 A 欄的金額。<p><strong>注意事項：</strong>您還可以使用減號 (-) 反轉資料欄中的符號。 例如，使用 <strong>-A+B</strong> 將 A 欄中的金額與 B 欄中的金額相加。</p> |
| \*       | A\*C                | A 欄的金額乘以 C 欄的金額。 |
| /        | A/C                 | 用 A 欄的金額除以 C 欄的金額。 |

#### <a name="use-a-calculation-formula-in-a-column-definition"></a>在欄定義中使用計算公式

1. 在 Report Designer 中，打開欄定義做修改。
2. 在相應 **CALC** 欄，在 **公式** 儲存格中輸入公式。

#### <a name="complex-calculations"></a>複雜的計算

複雜的計算可以包含儲存格參考、運算子、值和巢狀括號層級的任意組合。 例如，若要計算 A 欄和 B 欄的平均值，請使用計算公式 **((A+B)/2)**。

#### <a name="specify-report-cells-in-a-column-calculation"></a>在資料欄計算中指定報表儲存格

您可以透過輸入資料欄字母和資料列代碼來參考特定的報告儲存格。 例如，**B.100** 指 B 欄中的資料列代碼 100。您可以將整資料欄除以同一資料欄中的特定報表儲存格數量。 例如，計算 **B/B.100** 表示 B 欄中的金額應除以 B 欄中資料列代碼 100 中的值。如果計算指的是依賴於另一資料欄的資料欄，則首先解決依賴資料欄。 如果您將一資料欄參考到另一個參考回第一資料欄的資料欄，則會導致循環參考錯誤。

> [!NOTE]
> 如果您更改報告的計算優先順序，則計算可能不正確。 您可以在報表定義的 **設定** 索引標籤上設定計算優先順序。

#### <a name="multiply-or-divide-a-column-by-a-base-row"></a>將資料欄乘以或除以基準資料列

您可以建立資料欄，將指定資料欄中的所有值顯示為基數的百分比。 因此，您可以顯示資料列之間的關係，例如銷售資料列的百分比或總費用資料列的百分比。 若要將特定資料欄中的每一資料列乘以或除以基準資料列，請輸入要在計算中使用的資料欄，然後輸入 **\*BASEROW** 或 **/BASEROW**。 例如，輸入 **C\*BASEROW** 或 **C/BASEROW**。

> [!NOTE]
> 在欄定義中使用基準資料列計算時，請確保與此欄定義一起使用的每個列定義至少包含一個用於計算的基準資料列。

#### <a name="divide-the-amount-in-a-column-by-the-number-of-periods"></a>將資料欄中的金額除以週期數

您可以將某一資料欄的金額除以指定的週期數。 例如，公式 **B/Periods** 將 B 欄中的值除以 B 欄中的週期數。如果計算跨越多個資料欄，請指定要在計算中使用的週期數。 例如，公式 **(B+C)/Periods** 將 B 欄和 C 欄中的金額相加，然後將結果除以週期值。

## <a name="additional-resources"></a>其他資源

[財務 Report Designer 中的列定義](row-definitions-financial-reporting.md)

[Financial Reporting 中的進階格式選項](advanced-formatting-options-financial-reporting.md)


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]