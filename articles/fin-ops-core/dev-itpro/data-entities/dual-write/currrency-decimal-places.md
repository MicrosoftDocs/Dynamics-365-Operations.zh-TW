---
title: 雙重寫入的貨幣資料類型移轉
description: 本主題介紹如何更改雙重寫入支援的貨幣小數位數。
author: RamaKrishnamoorthy
ms.date: 12/08/2021
ms.topic: article
audience: Application User, IT Pro
ms.reviewer: tfehr
ms.search.region: global
ms.author: ramasri
ms.search.validFrom: 2020-04-06
ms.openlocfilehash: e9dc3e6c5fbec9636370b64a9bbdcf8a5834d332
ms.sourcegitcommit: 4be1473b0a4ddfc0ba82c07591f391e89538f1c3
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/31/2022
ms.locfileid: "8460367"
---
# <a name="currency-data-type-migration-for-dual-write"></a>雙重寫入的貨幣資料類型移轉

[!include [banner](../../includes/banner.md)]



您可以將貨幣值支援的小數位數增加到最多 10 位。 預設限制為四位小數。 透過增加小數位數，有助於防止在使用雙重寫入同步資料時遺失資料。 小數位數的增加是一種選取加入的變化。 若要實施它，您必須向 Microsoft 要求幫助。

更改小數位數的過程有兩個步驟：

1. 向 Microsoft 要求移轉。
2. 更改 Dataverse 中的小數位數。

財務和營運應用程式和 Dataverse 必須支援相同的貨幣值小數位數。 否則，當這些資訊在應用程式之間同步時，可能會發生資料丟失。 移轉過程會重新設定貨幣和匯率值的儲存方式，但不會更改任何資料。 移轉完成後，可以增加貨幣代碼和定價的小數位數，使用者輸入和查看的資料可以有更多的小數精確度。

移轉為選取性選項。 如果更多小數位的支援對您可能有幫助，我們建議您考慮移轉。 不需要超過四位小數的值的組織不必移轉。

## <a name="requesting-migration-from-microsoft"></a>正在向 Microsoft 要求移轉

Dataverse 中現有貨幣資料欄的儲存不能支援超過四位小數。 因此，在移轉過程中，貨幣值被複製到資料庫中的新內部資料欄。 此過程會持續進行，直到所有資料都已移轉完畢。 在內部作業中，移轉結束時，新的儲存類型會替換舊的儲存類型，但資料值不變。 貨幣最多可以支援 10 位小數。 在移轉過程中，Dataverse 可以不間斷地繼續使用。

同時，匯率進行了修改，以支援最多 12 位小數，而不是現行的 10 位限制。 此更改為必要性，以便財務和營運應用程式和 Dataverse 中的小數位數相同。

移轉不會更改任何資料。 貨幣和匯率資料欄轉換後，管理員可以透過指定每種交易貨幣和定價的小數位數，將系統設定為貨幣資料欄最多使用 10 位小數。

### <a name="request-a-migration"></a>要求移轉

若要提供此函數，請發送電子郵件至 **CDSExpandDecimal@microsoft.com**，並包括以下資訊：

+ **主題：** 要求啟用對 \<organizationID\> 的擴展十進位支援
+ **內文：** 我想為我的 org \<organizationID\> 啟用擴展的十進位支援。

Microsoft 代表將在兩到三個工作日內與您聯絡以了解後續步驟。

當您要求移轉時，您應該了解以下詳情並相應地進行規劃：

+ 移轉資料所需的時間取決於系統中的資料量。 大型資料庫的移轉可能需要幾天時間。
+ 移轉執行階段，資料庫的大小會暫時增加，因為索引需要額外的空間。 移轉完成後，大部分額外空間將被釋放。
+ 在移轉過程中，如果發生阻止移轉完成的錯誤，系統會向 Microsoft 支援部門發出警示，以便支援人員進行干預。 但是，即使在移轉過程中出現錯誤，Dataverse 仍然可以正常使用。
+ 移轉過程不可逆。

## <a name="changing-the-number-of-decimal-places"></a>正在更改小數位數

移轉完成後，Dataverse 可以儲存具有更多小數位的數字。 管理員可以選取用於特定貨幣代碼和定價的小數位數。 然後，Microsoft Power Apps、Power BI 和 Power Automate 的使用者可以查看和使用具有更多小數位的數字。

若要進行此更改，您必須更新以下的 Power Apps 設定：

+ **系統設定：定價的貨幣精確度** - **設定用於整個系統定價的貨幣精確度** 欄定義了在選取 **定價精確度** 時貨幣對組織的行為方式。
+ **企業管理：貨幣** - **貨幣精確度** 資料欄允許您為特定貨幣指定自訂小數位數。 組織範圍的設定有一個後援。

有一些限制：

+ 您不能在資料表上設定貨幣資料欄。
+ 您只能在 **定價** 和 **交易貨幣** 級別指定多於四位小數。

### <a name="system-settings-currency-precision-for-pricing"></a>系統設定：定價的貨幣精確度

移轉完成後，管理員可以設定貨幣精確度。 進入 **設定\>管理**，並選取 **系統設定**。 然後，在 **一般** 選項卡上，更改 **設定用於整個系統定價的貨幣精確度** 資料欄的值，如下圖所示。

![貨幣的系統設定。](media/currency-system-settings.png)

### <a name="business-management-currencies"></a>企業管理：貨幣

如果您要求特定貨幣的貨幣精確度與用於定價的貨幣精確度不同，您可以更改它。 進入 **設定\>企業管理**，選取 **貨幣**，然後選取要更改的貨幣。 然後將 **貨幣精確度** 資料欄設定為所需的小數位數，如下圖所示。

![特定地區的貨幣設定。](media/specific-currency.png)

### <a name="tables-currency-column"></a>資料表：貨幣資料欄

可為特定貨幣資料欄設定的小數位數限制為四位。

### <a name="default-currency-decimal-precision"></a>預設貨幣小數精確度
對於移轉和非移轉場景下預設貨幣小數精確度的預期行為，請參見下表。 

| 建立日期  | 貨幣小數欄位    | 現有組織 (貨幣欄位未移轉) | 現有組織 (貨幣欄位已移轉) | 在組建 9.2.21062.00134 之後建立的新組織 |
|---------------------------------------------------------|-------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------|------------------------------------------------|
| 在組建 9.2.21111.00146 之前建立的貨幣欄位  |     |  |       |
|    | UI 中可見的最大精確度   | 4 位數    | 10 位數    | 不適用    |
| | 資料庫和資料庫查詢結果 UI 中可見的最大精確度         | 4 位數   | 10 位數   | 不適用    |
| 在組建 9.2.21111.00146 之後建立的貨幣欄位 |    |  |     |   |
|   | UI 中可見的最大小數精確度     | 4 位數   | 10 位數   | 10 位數     |
|          | 資料庫和資料庫查詢結果 UI 中可見的最大小數精確度 | 10 位數。 但是，只有 4 位是有效的，並且 4 位十進位數字之外的所有零都是有效的。 如果需要，這可以實現更簡單、更快速的組織移轉。 | 10 位數      | 10 位數     |

[!INCLUDE[footer-include](../../../../includes/footer-banner.md)]
