---
title: 格線功能
description: 本主題介紹了格線控制項的幾個強大功能。 您必須啟用新的格線功能才能存取這些功能。
author: jasongre
ms.date: 03/03/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: DefaultDashboard
audience: Application User, Developer, IT Pro
ms.reviewer: sericks
ms.search.region: Global
ms.author: jasongre
ms.search.validFrom: 2020-02-29
ms.dyn365.ops.version: Platform update 33
ms.openlocfilehash: 58a05f893549a8b9e2e5cb83d02475d0fb5b7277
ms.sourcegitcommit: 2e554371f5005ef26f8131ac27eb171f0bb57b4e
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/04/2022
ms.locfileid: "8460445"
---
# <a name="grid-capabilities"></a>格線功能

[!include [banner](../includes/banner.md)]
[!include [preview banner](../includes/preview-banner.md)]

新的格線控制項提供了一些有用且強大的功能，您可以使用這些功能來提高使用者工作效率、構建更有趣的資料檢視表以及對資料進行有意義的洞察。 本文將介紹以下功能： 

- 計算總數
- 在該系統前打字
- 評估數學運算式 
- 分組表格資料 (透過使用 **在格線中分組** 功能分開啟用)
- 凍結欄 (透過使用 **凍結格線中的列** 功能分開啟用)
- 自動調整欄寬
- 可伸縮資料欄

## <a name="calculating-totals"></a>計算總數
在財務和營運應用程式中，使用者可以在格線中的數字欄底部查看總數。 格線底部的頁尾部分顯示了這些總數。 

### <a name="showing-the-grid-footer"></a>顯示格線頁尾
財務和營運應用程式中每個表格格線的底部都有一個頁尾區域。 頁尾可以顯示與格線中出現的資料相關的有價值的資訊。 以下是此資訊的部分範例：

- 資料表中選定的列數 (當您選取多條記錄時)
- 配置的數字欄底部的總數
- 資料集中的列數 

此頁尾預設隱藏，但您可以將其打開。 若要顯示格線的頁尾，請選取 **格線選項** 按鈕，然後選取 **顯示頁尾** 選項。 打開特定格線的頁尾後，將記住該設定，直到使用者選取隱藏頁尾。 若要隱藏頁尾，請選取 **格線選項** 選單的 **隱藏頁尾**。

### <a name="specifying-columns-with-totals"></a>指定總數欄
目前，預設情況下沒有資料欄顯示總數。 相反，這被認為是一次性設定活動，類似於調整格線中的欄寬。 一旦您指定要查看某欄的總數，該設定將在您下次存取該頁面時被記住。

有兩種方法可以配置資料欄以顯示總數： 

- 按右鍵點選要查看總數的資料欄，然後選取 **總數此欄**。 此動作會導致三個事件發生：

    1. 頁尾變得可見。 
    2. 您希望查看此欄總數的偏好設定已儲存。 
    3. 為此欄和您之前配置為查看總數的任何其他資料欄啟動總數計算。 顯示總數所需的時間取決於您要總數的資料集的大小。

- 在頁尾可見後，在要查看總數的列底部的頁尾區域中選取 **顯示總數**。 如果沒有已配置的資料欄，則 **顯示總數** 按鈕將可用於所有數字欄。 

    在為總數配置至少一欄後，**顯示總數** 按鈕僅在懸停或聚焦時可用。 選取 **顯示總數** 的動作只儲存您在此欄中查看總數的偏好，以便在以後存取該頁面時應用該偏好。 在頁尾中，此狀態由資料欄中出現的破折號表示。 (或者，如果資料集足夠小，則會立即顯示總數。)

如果您出錯並且不想再查看特定欄中的總數，請按右鍵點選該欄並選取 **隱藏總數** 或選取該欄頁尾中的 **隱藏總數** 按鈕。 此偏好設定也將被儲存以供將來存取該頁面。 

### <a name="calculating-totals"></a>計算總數
當您來到一個頁尾可見的頁面，並且已經為總數配置了資料欄，總數可能會也可能不會顯示在頁尾。 該行為取決於頁面上資料集的大小。 如果資料集足夠小，將自動顯示總數以及資料集中的列數。 如果您為總數已配置資料欄下方的頁尾中有破折號，則資料集太大，系統無法立即顯示總數，需要明確動作來計算總數。 為此，請點選頁尾中的 **計算** 按鈕，或按右鍵點選要總數的資料欄並選取 **加總此欄**。

如果計算需要很長時間才能完成，您可以透過選取 **取消** 按鈕。 有時，資料集太大而無法計算總數 (您的組織施加的限制)，而是會通知您更多地篩選資料。 

> [!NOTE]
> 系統管理員可以透過調整 **用戶端效能選項** 頁面上的 **每個格線的最大本地記錄數** 參數來修改可用於計算總數的記錄數限制。 預設值為 25,000 記錄。 系統管理員在調整這個值時應注意，因為太大的值會耗盡使用者機器上的可用記憶體。 建議不要超過 50,000 條記錄。   

當您在資料集中更新、刪除或建立資料列時，總數將自動更新。

## <a name="typing-ahead-of-the-system"></a>在該系統前打字
在很多業務場景中，快速將資料輸入系統的能力非常重要。 在引入新的格線控制項之前，使用者只能更改目前資料列中的資料。 在他們可以建立新列或切換到不同的列之前，他們被迫等待系統成功驗證任何更改。 為了減少使用者等待這些驗證完成的時間，並提高使用者的工作效率，新格線調整了這些驗證，使它們是非同步作業。 因此，該使用者可以移動到其他列以進行更改，而之前的行驗證尚未完成。 

為了支援這種新行為，當格線處於編輯模式時，資料列狀態的新資料欄已新增到列選取資料欄的右側。 此資料欄指示以下狀態之一：

- **空白** – 無狀態影像表示該列已被系統成功儲存。
- **待處理** – 此狀態表示該列中的更改尚未被伺服器儲存，但位於必須處理的更改佇列中。 在您於格線之外採取行動之前，您必須等待處理所有待處理的更改。 此外，這些資料列中的文字以斜體表示，以指示該列的未儲存狀態。 
- **無效狀態** – 此狀態表示在處理資料列期間觸發了某些警告或訊息，並且可能阻止系統儲存該列中的更改。 在舊格線中，如果儲存動作不成功，您將被迫回到該列中以立即解決問題。 但是，在新格線中，您會收到遇到驗證問題的通知，但您可以決定何時要修復資料列中的任何問題。 當您準備好解決問題時，您可以手動將焦點移回該列。 或者，您可以選取 **修復此問題** 動作。 此動作會立即將焦點移回有問題的資料列，並允許您在格線內部或外部進行編輯。 請注意，在這個驗證警告解決之前，會停止處理後續的待處理資料列。 
- **暫停** – 此狀態表示伺服器的處理已暫停，因為資料列的驗證觸發了需要使用者輸入的彈出式對話方塊。 因為使用者可能在其他列中輸入資料，所以彈出式對話方塊不會立即呈現給該使用者。 相反，它將在使用者選取恢復處理時顯示。 此狀態伴隨著通知，通知使用者有關該情況。 通知包括將觸發彈出式對話方塊的 **繼續處理** 動作。

當使用者在伺服器處理的地方之前輸入資料時，他們可能會預期資料輸入體驗會有所下降，例如缺少查詢、控制級別驗證和輸入預設值。 鼓勵需要下拉式清單來查詢值的使用者等待伺服器趕上目前的資料列。 當伺服器處理該列時，也會發生控制級別的驗證和預設值的輸入。

### <a name="pasting-from-excel"></a>從 Excel 貼上
透過使用 **匯出到 Excel** 機制，使用者都能夠將資料從財務和營運應用程式中的格線匯出到 Microsoft Excel。 但是，在系統之前輸入資料的能力使新格線能夠支援從 Excel 複製表格並將它們直接貼到財務和營運應用程式的格線中。 貼上動作啟動的格線儲存格決定了已複製資料表開始貼上的位置。 該格線的內容會被已複製表格的內容覆寫，但以下兩種情況除外：

- 如果已複製資料表中的資料欄數超過格線中保留的欄數，則從貼上位置開始，通知使用者多餘的資料欄已被忽略。 
- 如果已複製資料表中的列數超過格線中的列數，則從貼上位置開始，現有儲存格將被貼上的內容覆蓋，已複製資料表中的任何額外資料列都將作為新列插入底部的格線。 

## <a name="evaluating-math-expressions"></a>評估數學運算式
作為生產力助推器，使用者可以在格線的數字儲存格中輸入數學公式。 他們不必在系統外的應用程式中進行計算。 例如，如果您輸入 **=15\*4** 然後按 **Tab** 鍵移出該欄位，該系統將評估運算式並在該欄位儲存 **60** 的值。

若要使該系統將值識別為運算式，請以等號 (**=**) 開始該值。 如需支援的運算子和語法的相關資訊，請參閱[支援的數學符號](http://bugwheels94.github.io/math-expression-evaluator/#supported-maths-symbols)。

## <a name="grouping-tabular-data"></a>分組表格資料
商務使用者經常需要對資料進行臨時分析。 雖然這可以透過將資料匯出到 Microsoft Excel 並使用資料樞紐分析表來完成，但依賴於新格線控制功能的 **格線中分組** 功能允許使用者在財務和營運應用程式中以有趣的方式組織其表格資料。 由於此功能擴展了 **總數** 功能，因此 **分組** 允許您透過在組級別提供小計來獲得對資料的有意義的見解。

若要使用此功能，請按右鍵點選要分組的資料欄，然後選取 **按此欄分組**。 此動作將按所選資料欄對資料進行排序，將新的 **分組依據** 欄新增到格線的開頭，並在每個組的開頭插入「標題列」。 這些標題列提供每個組的以下相關資訊：

- 該組的資料值 
- 資料欄名稱 (當您有多個級別的分組時，此資訊特別有用)
- 此組中的資料列數
- 任何被配置為顯示總數之資料欄的小計

啟用[已儲存檢視表](saved-views.md)後，可以透過個人化將此分組儲存為檢視表的一部分，以便下次存取該頁面時快速存取。

### <a name="multiple-levels-of-grouping"></a>多層次的分組
按單個資料欄對資料進行分組後，您可以透過在所需資料欄上選取 **按此欄分組** 來按不同的資料欄對資料進行分組。 可以重複此過程，直到您有 5 個巢狀級別的分組，這是支援的最大深度。 此時，您將無法再按其他欄進行分組。

在任何時候，您都可以透過按右鍵點選該欄並選取 **取消分組** 來刪除任何資料欄上的分組。 您還可以透過選取 **格線選項**，然後選取 **全部取消分組** 來從所有欄中刪除分組。

### <a name="sorting-grouped-data"></a>對分組資料進行排序
按一欄或多欄對資料進行分組後，您可以透過相應的欄標題更改任何分組欄的排序方向。 

對未分組的欄進行排序時的行為取決於您的產品版本：

- 在 10.0.24 及更早版本中，如果您對未分組的資料欄進行排序，則會從所有欄中刪除分組，並在選定欄上對資料進行排序。 
- 在 10.0.25 及更新版本中，如果您對未分組的資料欄進行排序，則分組保持不變，並且根據所選欄在每個組內對資料進行排序。

### <a name="expanding-and-collapsing-groups"></a>展開和摺疊群組
資料的初始分組將展開所有組。 您可以透過摺疊各個組來建立資料的匯總檢視表，也可以使用組展開和摺疊來幫助瀏覽資料。 若要展開或摺疊組，請選取相應組標題列中的 V 形 (>) 按鈕。 請注意，個別組的展開/摺疊狀態 **不會** 儲存在個人化設定中。

### <a name="selecting-and-unselecting-rows-at-the-group-level"></a>在分組級別選取和取消選取資料列
就像您可以透過選取格線中第一欄頂部的核取方塊來選取 (或取消選取) 格線中的所有列一樣，您也可以透過選取相應組標題列的核取方塊來快速選取 (或取消選取) 組中的所有列。 群組標題列中的核取方塊將一直反映該組中資料列的目前選取狀態，無論是選取所有列、未選取列還是僅選取部分資料列。

### <a name="hiding-column-names"></a>隱藏資料欄名稱
對資料進行分組時，預設行為是在群組標題列中顯示資料欄名稱。 您可以選取隱藏群組標題列中的資料欄名稱，方法是選取 **格線選項** > **隱藏群組資料欄名稱**。

### <a name="grouping-on-date-and-time-columns"></a>按日期和時間欄分組
從版本 10.0.24 開始，對於日期或日期時間欄位，該選項已新增到年、月或日分組。 相應標題列中的群組「值」將比對該欄位的格式。 此外，對於日期時間和時間欄位，您可以按小時、分鐘或秒分組。 

## <a name="freezing-columns"></a>凍結欄
格線中的某些欄對於您不希望它們滾動到檢視表之外的內容可能足夠重要。 相反，您可能希望這些欄中的值一直顯示。 **格線中的凍結欄** 功能為使用者提供了這種彈性。 

若要凍結資料欄，請按右鍵點選欄標題，然後選取 **凍結欄**。 第一次完成此步驟時，選定的欄將成為第一欄，並且不再滾動到檢視表之外。 您凍結的任何後續資料欄都將新增到最後一個凍結欄的右側。 您可以根據需要使用標準移動函數對凍結欄重新排序。 但是，無法移動凍結的資料欄，以便它們出現在一組未凍結的資料欄中。 同樣，無法移動未凍結的資料欄，以便它們出現在已凍結的資料欄集中。

若要解凍資料欄，請按右鍵點選已凍結欄的標題，然後選取 **解凍欄**。 

請注意，新格線中的資料列選取和列狀態欄一直凍結為前兩欄。 因此，當這些資料欄包含在格線中時，無論格線中的水平滾動位置如何，它們始終可顯示給使用者。 這兩欄無法重新排序。

## <a name="autofit-column-width"></a>自動調整欄寬
與 Excel 類似，使用者可以根據該欄中目前顯示的內容自動強制調整欄的大小。 為此，請按兩下點選欄中的調整大小手柄，或將焦點置於欄標題並按 **A** (用於自動調整)。 從版本 10.0.23 開始提供此功能。

## <a name="frequently-asked-questions"></a>常見問題
### <a name="how-do-i-enable-the-new-grid-control-in-my-environment"></a>如何在我的環境中啟用新的格線控制項？ 

**新的格線控制** 功能可在任何環境中直接在功能管理中使用。 在功能管理中啟用該功能後，所有後續使用者工作階段都將使用新的格線控制項。 

從版本 10.0.21 開始預設啟用此功能，並且目標是在版本 10.0.25 中成為強制功能。 

## <a name="developer-opting-out-individual-pages-from-using-the-new-grid"></a>[開發人員] 選取不使用新格線的單個頁面 
如果您的組織發現頁面在使用新格線時存在一些問題，則可以使用 API 來允許單個表單使用舊格線控制項，同時仍允許系統的其餘部分使用新格線控制項。 若要從新格線中選取退出單個頁面，請在表單的 `run()` 方法中新增以下調用過帳 `super()`。

```this.forceLegacyGrid();```

在新的格線控制項成為強制性之前，此 API 將一直有效。 這一變化目前的目標是 2022 年 10 月。 如果有任何問題需要使用此 API，請將它們報表給 Microsoft。

### <a name="forcing-a-page-to-use-the-new-grid-after-previously-opting-out-the-grid"></a>在先前選取退出格線後強制頁面使用新格線
如果您已選取退出使用新格線的單個頁面，您可能希望稍後在解決基本問題後重新啟用新格線。 為此，您只需刪除對 `forceLegacyGrid()` 的調用。 在發生以下情況之一之前，此更改不會生效：

- **環境重新部署**：當環境更新和重新部署時，儲存已選取退出新格線的頁面的表 (FormControlReactGridState) 會自動清除。
- **手動清理資料表**：對於開發場景，您需要使用 SQL 清除 FormControlReactGridState 表，然後重新啟動 AOS。 這種動作組合將重設已選取退出新格線的頁面的快取。

## <a name="developer-opting-individual-grids-out-of-the-typing-ahead-of-the-system-capability"></a>[開發人員] 在系統功能之前選取單個格線退出打字
已經出現了一些不適合使用格線的 *在系統之前輸入* 功能的場景。 (例如，在驗證行時觸發的某些代碼會導致觸發資料來源研究，然後研究可能會破壞現有列上未送出的編輯。) 如果您的組織發現這種情況，則可以使用 API，讓開發人員從非同步列驗證中選取單個格線並恢復為舊行為。

當格線中的非同步列驗證被停用時，在目前資料列存在驗證問題時，使用者不能在格線中建立新列或移動到另一個現有列。 作為此動作的副作用，無法將表從 Excel 貼到財務和營運應用程式格線中。

若要使單個格線退出不同步列驗證，請在表單的 `run()` 方法中的 `super()` 之後新增以下調用。

```<gridControl>.allowPreemptiveClient(false);```

> [!NOTE]
> - 此調用應僅在特殊情況下調用，不應成為所有格線的規範。
> - 我們不建議您在表單載入後在執行階段切換此 API。

## <a name="developer-size-to-available-width-columns"></a>[開發人員] 調整到可用寬度的資料欄
如果開發人員為新格線內的資料欄將 **WidthMode** 屬性設定為 **SizeToAvailable**，那麼這些資料欄最初的寬度與設定為 **SizeToContent** 時的寬度相同。 但是，它們會延展以使用格線內的任何額外可用寬度。 如果將該屬性為多個資料欄設定為 **SizeToAvailable**，則所有這些資料欄在格線內共享任何額外的可用寬度。 但是，如果使用者手動調整其中一欄的大小，該資料欄將變為靜態。 它將保持在該寬度，並且不再延展以佔用額外的可用格線寬度。

## <a name="known-issues"></a>已知問題
本節維護新格線控制項的已知問題清單。

### <a name="open-issues"></a>未結問題
- 啟用 **新建格線控制項** 功能後，部分頁面將繼續使用現有的格線控制項。 這將在以下情況下發生：
 
    - 頁面上存在一個卡片清單，它以多資料欄呈現。
    - 頁面上存在分組卡清單。
    - 具有非反應可擴展控制項的格線欄。

    當使用者第一次遇到其中一種情況時，將顯示一條有關重新整理頁面的訊息。 出現此訊息後，頁面將繼續為所有使用者使用現有格線，直到下一次產品版本更新。 未來的更新將考慮更好地處理這些場景，以便可以利用新的格線。

- [KB 4582758] 當您將縮放比例從 100 更改為任何其他百分比時，記錄會變得模糊
- [KB 4592012] 從 Excel 貼多行時，IE11 中出現意外的用戶端錯誤

    Microsoft 不尋求解決此問題


[!INCLUDE[footer-include](../../../includes/footer-banner.md)]
