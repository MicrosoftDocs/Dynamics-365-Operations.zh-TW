---
title: 開始使用稅金計算
description: 本主題說明如何設定稅金計算。
author: wangchen
ms.date: 01/05/2022
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: TaxIntegrationTaxServiceParameters
audience: Application user
ms.reviewer: kfend
ms.search.scope: Core, Operations
ms.custom: intro-internal
ms.search.region: Global
ms.author: wangchen
ms.search.validFrom: 2021-04-01
ms.dyn365.ops.version: 10.0.18
ms.openlocfilehash: ae2c20fe79c2f8fd8d102740441230ae443f16a3
ms.sourcegitcommit: f5fd2122a889b04e14f18184aabd37f4bfb42974
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/10/2022
ms.locfileid: "8451329"
---
# <a name="get-started-with-tax-calculation"></a>開始使用稅金計算

[!include [banner](../includes/banner.md)]

本主題提供有關如何開始使用稅金計算的資訊。 本主題各節引導您完成 Microsoft Dynamics Lifecycle Services (LCS)、Regulatory Configuration Service (RCS)、Dynamics 365 Finance 和 Dynamics 365 Supply Chain Management 的高階設計與組態步驟。 

設定包含三大主要步驟。

1. 在 LCS 安裝稅金計算增益集。
2. 在 RCS 設定稅金計算功能。 這項設定並非法人實體的特定專用設定。 它可以橫跨 Finance 和 Supply Chain Management 的法人實體之間共享。
3. 在 Finance 和 Supply Chain Management 按法人實體設定稅金計算參數。

## <a name="high-level-design"></a>高階設計

### <a name="runtime-design"></a>執行階段設計

下圖顯示稅金計算的高階執行階段設計。 因為稅金計算可以整合多個 Dynamics 365 應用程式，所以插畫使用與 Finance 的整合為範例。

1. 如銷售訂單或採購訂單的交易在 Finance 建立。
2. Finance 自動使用銷售稅群組和分項銷售稅群組的預設值。
3. 當在交易上選取 **銷售稅** 按鈕時，會觸發稅金計算。 接著 Finance 將酬載傳送到稅金計算服務。
4. 稅金計算服務將酬載與稅務功能的預定義規則配對，以便同時尋找更準確的銷售稅群組和分項銷售稅群組。

    - 如果酬載能和 **稅務組適用性** 矩陣配對成功，它會使用與適用性規則相符的稅務組值覆寫銷售稅群組值。 否則它會繼續使用 Finance 的銷售稅群組值。
    - 如果酬載能和 **分項稅務組適用性** 矩陣配對成功，它會使用與適用性規則相符的分項稅務組值覆寫分項銷售稅群組值。 否則它會繼續使用 Finance 的分項銷售稅群組值。

5. 稅金計算服務藉由使用銷售稅群組和分項銷售稅群組的交集來判定最終稅籍代碼。
6. 稅金計算服務根據它判定的最終稅籍代碼計算稅金。
7. 稅金計算服務將稅金計算結果傳回 Finance。

![稅金計算執行階段設計。](media/tax-calculation-runtime-logic.png)

### <a name="high-level-configuration"></a>高階組態

下列步驟提供稅金計算服務組態流程的高階概觀。

1. 在 LCS 安裝您的 LCS 專案 **稅金計算** 增益集。
2. 在 RCS 建立 **稅金計算** 功能。
3. 在 RCS 設定 **稅金計算** 功能：

    1. 請選取稅金組態版本。
    2. 建立稅籍代碼。
    3. 建立稅務組。
    4. 建立分項稅務組。
    5. 選項：如果您想要覆寫從客戶或供應商主資料輸入的預設銷售稅務組，請建立稅務組適用性。
    6. 選項：如果您想要覆寫從分項主資料輸入的預設分項銷售稅務組，請建立分項稅務組適用性。

4. 在 RCS 完成並發佈 **稅金計算** 功能。
5. 在財務選取已發佈的 **稅金計算** 功能。

完成這些步驟後，下列設定會自動從 RCS 同步到 Finance。

- 銷售稅籍代碼
- 銷售稅務組
- 分項銷售稅務組

本主題的其餘各節提供更詳細的組態步驟。

## <a name="prerequisites"></a>前提條件

在您可以完成本主題的其餘程序之前，必須滿足下列前提條件：<!--TO HERE-->

- 您必須有權存取您的 LCS 科目，並且已部署的 LCS 專案必須具備執行 Dynamics 365 版本 10.0.21 或更高版本的第 2 層或更高層的環境。
- 您必須為貴公司建立 RCS 環境，並且有權存取您的科目。 更多有關如何建立 RCS 環境的資訊，請參閱[Regulatory Configuration Service Overview](rcs-overview.md)。
- 下列功能必須在您部署的 Finance 或 Supply Chain Management 環境的 **功能管理** 工作區，根據您的業務需求開啟：

    - 稅金計算服務
    - 支援多個增值稅註冊編號
    - 轉單稅金

- 下列功能必須在您部署的 RCS 環境的 **功能管理** 工作區開啟。

    - 全球化功能

## <a name="set-up-tax-calculation-in-lcs"></a>在 LCS 設定稅金計算

1. 登入 [LCS](https://lcs.dynamics.com)
2. 完成 Microsoft Power Platform 整合設定。 更多資訊，請參閱[增益集概觀](../../fin-ops-core/dev-itpro/power-platform/add-ins-overview.md)。
3. 請選取您部署的其中一個環境和 **安裝新增益集**。
4. 請選取 **稅金計算**。
5. 閱讀並同意條款和條件，然後選取 **安裝**。

## <a name="set-up-tax-calculation-in-rcs"></a>在 RCS 設定稅金計算

本節各個步驟與特定法人實體無關。 您必須只能一次性完成這段流程，並且可以在 RCS 的任何法人實體完成。

1. 登入 [RCS](https://marketing.configure.global.dynamics.com/)。
2. 請在 **電子報表** 工作區新增組態提供者。 請將貴公司名稱當成提供者名稱。 更多資訊，請參閱[建立組態提供者並標示為有效](../../fin-ops-core/dev-itpro/analytics/tasks/er-configuration-provider-mark-it-active-2016-11.md)。
3. 請選取剛建立的組態提供者及 **設定有效**。
4. 請選取 **Microsoft** 組態提供者和 **儲存庫**。
5. 請在 **類型** 欄位選取 **全球**。
6. 請選取 **打開**。
7. 請前往 **Tax Data Model**，展開檔案樹狀結構並選取 **Tax Configuration**。
8. 請選取正確的 [Tax Configuration 版本](global-tax-calcuation-service-overview.md#versions)，接著根據您的 Finance 版本選取 **匯入**。
9. 請在 **全球化功能** 工作區選取 **Features** 和 **稅金計算** 圖格，並選取 **Add**。
10. 請選取下列其中一個功能類型：

    - **新功能** – 建立內容空白的功能設定。
    - **根據既有功能** – 從既有功能建立功能，並從既有功能設定複製內容。

11. 輸入功能名稱和描述，然後選取 **建立功能**。

    建立功能後會自動建立它的草稿版本。 您可以選取 **獲得此版本**，按照任何已完成的版本重新改變草稿版本的基準。

12. 請選取功能的草稿版本和 **編輯**。 請填寫 **稅金計算設定** 頁。
13. 請選取 **組態版本**。 您應該會看到步驟 8 匯入的組態版本。

    Microsoft 提供稅金計算的預設稅金組態。 此組態涵蓋大部分稅金計算行為的要求。 它將根據市場反饋意見更新。 如果您必須擴充組態以符合特定要求，請參閱[如何在稅金服務組建擴充功能](./tax-service-add-data-fields-tax-integration-by-extension.md)，了解有關如何產生和選取屬於您自己的稅金組態資訊。

14. 待您選取 **組態版本** 之後，會出現幾個額外的索引標籤。 請按照這裡顯示的順序完成強制索引標籤設定。

    **強制設定**

    - **稅籍代碼** – 維護稅籍代碼的主資料。 當您啟用當前版本時，在此索引標籤上建立的所有稅籍代碼都會自動同步到 Finance。
    - **稅務組** – 定義群組下方的稅務組主資料和稅籍代碼。
    - **分項稅務組** – 定義群組下方的分項稅務組主資料和稅籍代碼。

    **選配設定**

    - **稅務組適用性** – 定義判定稅務組的矩陣。 如果這個矩陣的適用性規則與 Dynamics 365 的課稅文件均不相符，則稅金計算會使用課稅文件行的預設值。
    - **分項稅務組適用性** – 定義判定分項稅務組的矩陣。 如果這個矩陣的適用性規則與 Dynamics 365 的課稅文件均不相符，則稅金計算會使用課稅文件行的預設值。
    - **客戶稅籍編號適用性** – 如果您有一位客戶的多個稅籍編號，稅金計算會自動判定正確的註冊稅號。 在此索引標籤上的矩陣中定義應該用來判定的規則。 否則，Finance 和 Supply Chain Management 將繼續使用課稅文件上的預設稅籍編號進行銷售交易。
    - **供應商稅籍編號適用性** – 如果您的一位供應商有多個稅籍編號，稅金計算會自動判定正確的稅籍編號。 在此索引標籤上的矩陣中定義應該用來判定的規則。 否則，Finance 和 Supply Chain Management 將繼續使用課稅文件上的預設稅籍編號進行購買交易。
    - **清單代碼適用性** – 自動透過更靈活與可配置規則判定 **清單代碼** 值。 在此索引標籤上的矩陣中定義應該用來判定的規則。 否則，Finance 和 Supply Chain Management 將繼續使用課稅文件上的預設代碼。

14. 請在 **稅籍代碼** 索引標籤上選取 **新增**，然後輸入稅籍代碼和說明。
15. 請選取 **稅金組成部份**。 稅金組成部份是在前一個選取稅金組態版本中定義的一組方法。 可以使用的稅金組成部分如下：

    - 按照淨額
    - 按照總額
    - 按照數量
    - 按照保證金
    - 稅金的徵稅

16. 選取 **儲存**。 根據您選取的稅金組成部份，愈多欄位變成可用欄位。
17. 請使用下列選項辨識稅籍代碼的性質：

    - 免稅
    - 是使用稅
    - 反向稽徵
    - 從基礎金額計算排除

    使用稅方案方面，設定正稅率的單稅籍代碼，並標示為 **是使用稅**。

    反向稽徵方案方面，設置兩個稅籍代碼，一個有正稅率，另一個有負稅率但稅率值相同。 負稅籍代碼標示為 **是反向稽徵**。 更多有關 Finance 的反向稽徵解決方案的資訊，請參閱[增值稅/消費稅計畫的反向稽徵機制](emea-reverse-charge.md)。

    對於某些應該排除在含價格交易課稅基礎金額計算範圍外的稅金類型 (例如某些國家或地區的關稅)，請選取 **從基本金額計算排除** 勾選方塊。 更多有關此參數的資訊，請參閱[啟用含稅價格時計算價格的稅金](global-exclude-from-tax-base-amount-calculation.md)。

    維護此稅籍代碼的稅率和稅額上限。

18. 重複步驟 14 到 17 新增所需的所有其他稅籍代碼。
19. 請在 **稅務組** 索引標籤上選取 **稅務組** 欄位，並新增到矩陣作為輸入條件，接著新增行項維護稅務組主資料。

    範例如下。

    | 稅務組    | 稅籍代碼           |
    | ------------ | ------------------- |
    | DEU_國內 | DEU_VAT19；DEU_VAT7 |
    | DEU_EU       | DEU_免稅          |
    | BEL_國內 | BEL_VAT21; BEL_VAT6 |
    | BEL_EU       | BEL_免稅          |

20. 請在 **分項稅務組** 索引標籤上選取 **分項稅務組** 欄位，並新增到矩陣作為輸入條件，接著新增行項維護分項稅務組主資料。

    範例如下。

    | 分項稅務組 | 稅籍代碼                                    |
    | -------------- | -------------------------------------------- |
    | 全滿           | DEU_VAT19; BEL_VAT21; DEU_Exempt; BEL_Exempt |
    | 減少的        | DEU_VAT7; BEL_VAT6; DEU_Exempt; BEL_Exempt   |

21. 請在 **稅務組適用性** 索引標籤上選取判定正確稅務組所需的欄位，然後選取 **新增**。 輸入或選取各個欄位值。 **稅務組** 欄位將是這個矩陣的輸出。 如果未配置此索引標籤，將使用交易行項上的銷售稅務組。

    範例如下。

    | 商務流程 | 託運方 | 收貨方 | 稅務組    |
    | ---------------- | --------- | ------- | ------------ |
    | 銷售            | DEU       | DEU     | DEU_Domestic |
    | 銷售            | DEU       | FRA     | DEU_EU       |
    | 銷售            | BEL       | BEL     | BEL_Domestic |
    | 銷售            | BEL       | FRA     | BEL_EU       |

22. 請在 **分項稅務組適用性** 索引標籤上選取判定正確稅籍代碼所需的欄位，然後選取 **新增**。 輸入或選取各個欄位值。 **分項稅務組** 欄位將是這個矩陣的輸出。 如果未配置此索引標籤，將使用交易行項上的分項銷售稅務組。

    範例如下。

    | 分項代碼 | 分項稅務組 |
    | --------- | -------------- |
    | D0001     | 完整           |
    | D0003     | 減少的        |

    更多有關如何在稅金計算判定稅籍代碼的資訊，請參閱[增值稅務組和分項銷售稅務組判定邏輯](global-sales-tax-group-determination.md)。

23. 根據業務需求設定客戶稅籍編號、供應商稅籍編號和清單代碼的適用性。
24. 請選取 **儲存**，然後關閉此頁。
25. 請選取 **變更狀態**\>**完成**。 待狀態變更為 **完成** 後，就無法再編輯此版本。
26. 請選取 **變更狀態**\>**發佈**。 此版本的稅金功能設定將被推送到全域儲存庫，Finance 的每個法人實體將可見到。

## <a name="set-up-tax-calculation-in-dynamics-365"></a>在 Dynamics 365 設定稅金計算

待您在 RCS 完成設定後，您將會有稅金功能的發佈版本。 請按照下列步驟在 Finance 設定稅金計算。

本節的設定由法人實體完成。 您必須要為 Finance 啟用稅金計算的每個法人實體配置它。

1. 請在 Finance 前往 **稅金**\>**設定**\>**稅定配置**\> **稅金計算參數**。
2. 請在 **一般** 索引標籤上設定下列欄位：

    - **啟用 稅金計算服務** – 選取此勾選方塊啟用法人實體的稅金計算。 如果當前法人實體未啟用，則法人實體將繼續使用既有的 Tax Engine判定和計算稅金。
    - **功能設定** – 選取已發佈的法人實體稅金功能設定和版本。 更多有關如何設定和完成已發佈的稅金功能資訊，請參閱本主題的上節內容。
    - **業務流程** – 選取要啟用的業務流程。

3. 請在 **計算** 索引標籤上定義法人實體預期的進位規則。 更多有關進位邏輯的資訊，請參閱[稅金計算進位規則](https://go.microsoft.com/fwlink/?linkid=2166988)。
4. 請在 **錯誤處理** 索引標籤上定義法人實體預期的錯誤處理方法。 可用的三個選項如下：

    - 否
    - 警告
    - 錯誤

    您可以在 **明細** 區針對每個結果代碼設定錯誤處理方法。 或者，如果某些結果代碼未從稅金計算服務同步，您可以在 **一般** 區設定預設方法。

5. 請在 **多次增值稅註冊** 索引標籤上分別打開增值稅申報、歐盟銷售清單和 Intrastat，以便在多次增值稅註冊方案下工作。 更多有關多次增值稅註冊的稅金報表資訊，請參閱[多次增值稅註冊報表](emea-reporting-for-multiple-vat-registrations.md)。
6. 儲存設定並重覆每個額外法人實體的前面步驟。 當發佈新版本並且您想要套用它時，請在 **稅金計算參數** 頁的 **一般** 索引標籤上設定 **功能設定** 欄位 (請參閱步驟 2)。
