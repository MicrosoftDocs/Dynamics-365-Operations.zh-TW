---
title: 掃描文件的發票自動化
description: 本主題介紹了可用於供應商發票（甚至包括附件的發票）的端到端自動化的功能。
author: abruer
ms.date: 03/24/2021
ms.topic: article
ms.prod: ''
ms.technology: ''
ms.search.form: VendEditInvoiceHeaderStagingListPage
audience: Application User
ms.reviewer: roschlom
ms.search.region: Global
ms.author: shpandey
ms.search.validFrom: 2016-11-30
ms.dyn365.ops.version: AX 7.0.0
ms.openlocfilehash: f407d42fe624206e32a2f58fe8c7fcaf2df52c729a1d945d3d801f450b6ed129
ms.sourcegitcommit: 42fe9790ddf0bdad911544deaa82123a396712fb
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/05/2021
ms.locfileid: "8450213"
---
# <a name="invoice-automation-for-scanned-documents"></a>掃描文件的發票自動化

[!include [banner](../includes/banner.md)]

本主題介紹了可用於供應商發票（包括附件的發票）的端到端自動化的資料實體。

希望簡化其應付帳款 (AP) 流程的組織通常將發票處理識別為應該更高效的最佳流程領域之一。 在許多情況下，這些組織將紙本發票的處理工作交給了協力廠商光學字元辨識 (OCR) 服務提供者。 然後，他們會收到機器可讀取的發票中繼資料以及每張發票的掃描影像。 為了幫助實現自動化，隨後構建了一個「最後一段」解決方案，以便在發票系統中消耗這些製造物。 現在，透過發票自動化解決方案，此「最後一段」自動化已可以使用。

## <a name="solution-context"></a>解決方案環境

發票自動化解決方案啟用了一個標準介面，可以接受發票標題和發票明細的發票中繼資料，以及適用於發票的附件。 任何可以產生符合此介面之製造物的外部系統都將能夠傳送摘要來自動處理發票和附件。

下圖顯示了一個樣本整合案例，其中 Contoso 與 OCR 服務提供者合作處理廠商發票。 Contoso 的廠商透過電子郵件將發票傳送給服務提供者。 透過 OCR 處理，服務提供者產生發票中繼資料（標題和/或明細）和發票的掃描影像。 整合層之後會轉換成這些製造物，以便它們可以被消耗使用。

![樣本整合案例。](media/vendor_invoice_automation_01.png)

如果需要整合發票，則上述案例的幾種變化是可能發生的。 資料移轉是另一個案例，此介面可用於建立發票和附件。

### <a name="solution-components"></a>解決方案元件

解決方案磁碟使用量由以下元件組成：

+ 發票標題、發票明細和發票附件的資料實體
+ 發票的例外狀況處理
+ 發票中的並排附件檢視人員

本主題的其餘部分提供了這些解決方案元件的詳細說明。

## <a name="data-entities"></a>資料實體

資料封裝是必須傳送的工作單位，以便可以建立發票標題、發票明細和發票附件。 以下資料實體用於構成資料封裝的製造物：

+ 廠商發票標題
+ 廠商發票明細
+ 廠商發票文件附件

廠商發票文件附件是作為此功能的一部分引入的新資料實體。 已修改廠商發票標題實體，以便可以支援附件。 尚未為此功能修改廠商發票明細實體。

如需有關資料封裝的詳細資訊，請參閱[資料管理概述 ](../../fin-ops-core/dev-itpro/data-entities/data-entities-data-packages.md)。 如需有關如何使用資料管理工作區建立資料封裝的資訊，請參閱[處理和消耗 Dynamics 365 財務和營運應用程式解決方案的資料封裝](../../fin-ops-core/dev-itpro/lcs-solutions/process-data-packages-lcs-solutions.md)。

若要快速產生包含發票和附件的測試資料，請按照以下步驟操作。

1. 登入到您的執行個體。
1. 前往 **應付帳款** > **發票** > **待處理的廠商發票**。
1. 建立具有明細和附件的發票。

    > [!NOTE]
    > 附件必須是標題附件。 目前，廠商發票文件附件實體不支援行附件。

1. 打開 **資料管理** 工作區。
1. 建立包含廠商發票標題、廠商發票明細和廠商發票文件附件實體的匯出作業。
1. 匯出資料。
1. 將匯出的資料下載為一個封裝。 您現在可以使用該封裝將資料匯入目標執行個體以進行測試。

### <a name="determining-the-legal-entity-for-an-invoice"></a>確定發票的法律實體

透過資料封裝匯入的發票可以透過兩種方式與其所屬的法律實體相關聯：

+ 處理發票的匯入作業將其匯入到 **資料管理** 工作區中安排作業的同一公司。 也就是說，作業的公司決定了發票所屬的公司。
+ 當包含發票的資料封裝傳送到財務部時，呼叫方（即在財務部之外運行的整合應用程式）可以在 HTTP 要求中明確提及公司 ID。 在這種情況下，處理在財務部運行之作業的公司環境被覆寫，並且發票被匯入至透過 HTTP 要求傳遞的公司。

> [!NOTE]
> 這種行為是標準的資料管理行為。 為了完整起見，在發票的環境中對其進行了說明。

## <a name="exception-processing"></a>例外狀況處理

在廠商發票透過整合進入財務和營運的情況下，應付帳款團隊成員必須有一種簡單的方法來處理例外狀況或有問題的發票，並根據有問題的發票建立待處理的發票。 這種廠商發票的例外狀況處理現在是財務和營運的一部分。

### <a name="vendor-invoices-that-failed-to-import-list-page"></a>無法匯入清單頁面的廠商發票

發票例外狀況的新清單頁面在 **應付帳款** > **發票** > **匯入失敗** > **匯入失敗的廠商發票** 中有提供。 此頁面顯示了廠商發票標題資料實體中暫存資料表的所有廠商發票標題記錄。 請注意，您可以從 **資料管理** 工作區檢視相同的記錄。 您還可以執行與 **資料管理** 工作區的例外狀況處理功能相同的操作。 例外狀況處理功能已經為功能型使用者做了最佳化，使其更易於使用。

![例外狀況清單頁面。](media/vendor_invoice_automation_02.png)

此清單頁面包含了透過摘要進入的以下欄位：

+ **公司** – 發票所屬的公司
+ **錯誤訊息** – 資料管理框架發出的錯誤訊息，可說明無法建立發票的原因
+ **號碼** - 輸入發票編號
+ **發票帳戶**
+ **姓名** – 廠商的名稱
+ **廠商帳戶**
+ **訂購單** – 發票的訂購單 (PO) 編號
+ **過帳日期**
+ **發票日期**
+ **發票描述**
+ **貨幣**
+ **記錄**
+ **明細參考** – 來自外部系統的識別碼

    > [!NOTE]
    > 明細參考不是發票 ID。

此清單頁面還有一個預覽窗格，您可以透過以下方式使用它：

+ 檢視整個錯誤訊息，這樣您就不必展開格線中的 **錯誤訊息** 欄。

清單頁面支援以下操作：

+ **編輯** – 在編輯模式下打開例外狀況記錄，以便您修復問題。
+ **選項** – 存取清單頁面上可用的標準選項。 您可以使用 **新增至工作區** 選項將例外狀況清單頁面作為清單或磚釘選到您的工作區。

### <a name="vendor-invoices-that-failed-to-import-details-page"></a>無法匯入詳情頁面的廠商發票

當您啟動編輯模式時，有問題發票的 **未能匯入詳情的廠商發票** 頁面將打開。 如果帶有附件的發票存在問題，則不會顯示該附件。 附件必須重新附在發票上。

**未能匯入詳情的廠商發票** 頁面可讓您建立待處理發票。 在處理例外狀況過程中修復發票上的問題後，選取 **建立待處理發票** 按鈕以建立待處理的發票。 待處理的發票將在背景建立。 

### <a name="shared-service-vs-organization-based-exception-processing"></a>共用服務與組織型例外狀況處理的比對

例外狀況清單頁面支援標準的安全結構，**資料管理** 工作區支援處理暫存記錄。 可以透過以下方式保護發票匯入作業：

+ 按使用者角色
+ 按使用者
+ 按法律實體

![受使用者角色和法律實體保護的匯入作業。](media/vendor_invoice_automation_04.png)

如果為發票匯入作業配置了安全性，例外狀況清單頁面將採用這些設定。 使用者將只能看到此設定允許他們查看的發票例外狀況。

例如，Contoso 已決定按法律實體處理發票例外狀況。 因此，在發票匯入作業上配置了安全性，即法律實體 A 中的使用者只能看到法律實體 A 中的發票例外狀況，而法律實體 B 中的使用者只能看到法律實體 B 中的發票例外狀況。此設定實現發票例外狀況管理的職責隔離。

Contoso 還可以決定不強制實施任何安全措施，以便相同的使用者可以處理所有法律實體的發票例外狀況。 此設定啟用了用於管理發票例外狀況的共用服務案例。

## <a name="side-by-side-attachment-viewer"></a>並排附件檢視器

為了幫助您輕鬆檢視廠商發票的附件，開票流程中使用的以下頁面現在提供了附件檢視器：

+ **例外狀況處理**
+ **待處理的廠商發票** 頁面（在發票審核過程中也可供使用）
+ **發票日記帳** 查詢頁面（用於已過帳發票）

以下是附件檢視器提供的主要功能：

+ 檢視文件管理支援的所有附件類型（文件、影像、URL 和註釋）。
+ 檢視多網頁 TIFF 檔案。
+ 對影像檔案執行以下操作：
  + 強調顯示影像的某些部分。
  + 封鎖影像的某些部分。
  + 為影像添加註釋。
  + 放大和縮小影像。
  + 平移影像。
  + 復原和重做操作。
  + 適應影像適大小。

> [!NOTE]
> 這些操作僅適用於影像文件（JPEG、TIFF、PNG 等）。 您使用這些操作對影像所做的任何更改都將儲存到影像檔案中。 目前，附件檢視器不包括版本設定或審計功能。

### <a name="default-attachment"></a>預設附件

如果廠商發票有多個附件，您可以將其中一個文件設定為 **附件** 頁面上的預設附件。 **預設附件** 選項是作為此功能一部分添加的新選項。 此選項也在廠商發票文件附件資料實體中公開。 因此，可以透過整合設定預設附件。

只能將一個文件設定為預設附件。 將文件設定為預設附件後，打開發票時它會自動顯示在附件檢視器中。 如果您無法將任何文件設定為預設文件，檢視器不會在打開發票時自動顯示任何附件。

### <a name="showhide-invoice-attachments"></a>顯示/隱藏發票附件

**例外狀況處理**、**待處理發票** 和 **發票日記帳** 查詢頁面上可使用的新按鈕，可讓您顯示或隱藏附件檢視器。

## <a name="security"></a>安全性

附件檢視器中的以下操作可透過角色型的安全性進行控制：

+ 強調顯示
+ 封鎖
+ 註釋

### <a name="pending-vendor-invoices-page"></a>待處理的廠商發票頁面

以下權限為強調顯示、封鎖和註釋操作提供附件檢視器的單獨讀取權限或讀取/寫入權限：

+ **維護廠商發票影像** – 此權限提供讀取/寫入存取。
+ **檢視廠商發票影像** – 此權限提供單獨讀取存取。

以下職責為這些操作提供附件檢視器的單獨讀取存取權限或讀取/寫入存取權限：

+ **維護廠商發票** – 將維護廠商發票影像權限指派給此職責。
+ **查詢廠商發票狀態** – 將檢視廠商發票影像權限指派給此職責。

以下角色為這些操作提供附件檢視器的單獨讀取存取權限或讀取/寫入存取權限：

+ **應付帳款記帳員** 和 **應付帳款經理** – 將維護廠商發票職責指派給這些角色。
+ **應付帳款記帳員**、**應付帳款經理**、**應付帳款集中付款記帳員**，以及 **應付帳款付款記帳員** – 將查詢廠商發票狀態職責指派給這些角色。

### <a name="vendor-invoice-attachment"></a>廠商發票附件

以下權限為強調顯示、封鎖和註釋操作提供附件檢視器的單獨讀取權限或讀取/寫入權限。

> [!NOTE]
> 隨時可開始，本區段中提到的角色提供附件檢視器單獨存取發票影像的權限。 如果某個角色還必須具有影像的寫入權限，您可以使用此處描述的權限和職責授予對該角色的寫入權限。

+ **維護廠商發票標題實體影像** – 此權限提供附件檢視器讀取/寫入發票影像的存取權限。
+ **檢視廠商發票標題實體影像** – 此權限提供附件檢視器中的讀取/寫入發票影像權限。

以下職責為這些操作提供附件檢視器的單獨讀取存取權限：

+ **維護廠商發票** – 將維護廠商發票標題實體影像權限指派給此職責。

以下角色為這些操作提供附件檢視器的單獨讀取存取權限：

+ **應付帳款記帳員** 和 **應付帳款經理** – 將維護廠商發票職責指派給這些角色。

在預設情況下，如果使用者角色在任何頁面上提供編輯權限，使用者還將對附件檢視器具有強調顯示、封鎖和註釋操作的編輯權限。 但是，如果存在特定角色應該在頁面上而不是在附件檢視器上具有編輯權限的情況，則可以使用前面請單中的適當權限來滿足使用案例。


[!INCLUDE[footer-include](../../includes/footer-banner.md)]